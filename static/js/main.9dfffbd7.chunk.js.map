{"version":3,"sources":["pages/rating/ChartSection.tsx","components/NavigationBar.tsx","pages/rating/FormBlock.tsx","utils/index.ts","utils/BinaryIndexedTree.ts","utils/Rating.ts","pages/rating/UserInfoTable.tsx","utils/Data.ts","utils/Shape.ts","pages/rating/StatusCanvas.ts","pages/rating/RatingDistributionChartCanvas.ts","pages/rating/RatingDistributionGraph.tsx","pages/rating/ChartCanvas.ts","pages/rating/RatingGraph.tsx","pages/rating/index.tsx","utils/RatingColor.ts","pages/rating/HistoryTable.tsx","components/PaginationPanel.tsx","components/TopcoderLikeCircle.tsx","components/RatingCircle.tsx","pages/ranking/RankingTable.tsx","pages/ranking/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ChartTab","NavigationBar","useState","isOpen","setIsOpen","Navbar","color","light","expand","fixed","NavbarBrand","tag","Link","to","NavbarToggler","onClick","Collapse","navbar","Nav","className","NavItem","NavLink","style","marginRight","icon","faChartLine","faSortAmountDown","FormBlock","props","paramUser","user","setUser","ratingPagePath","useMemo","generatePath","history","useHistory","Row","Col","sm","FormGroup","width","Label","for","Input","value","type","name","id","placeholder","onChange","e","target","onKeyPress","key","push","Button","block","display","marginTop","pad","n","slice","getOrdinal","x","s","v","formatDate","d","year","String","getFullYear","month","getMonth","date","getDate","DAYS","formatDatetime","day","getDay","hours","getHours","minutes","getMinutes","getPer","l","r","getDiff","Math","abs","BinaryIndexedTree","_length","data","length","this","Array","fill","k","ret","sum","COLORS","getColor","i","RatingRanks","contestResultsArray","bit","user2rating","user2ratingRankHistory","ratings","Map","undefined","forEach","contestResults","username","rankingEntry","get","oldRating","rating","NewRating","match","Place","win","add","set","rank","query","has","aaa","console","log","from","values","map","sort","a","b","ratingAndRank","xaxis","index","findIndex","pop","ratingAndUsername","UserInfoTable","ratingHistory","ratingRanks","lastResult","lastCompeted","Date","EndTime","getRank","ratingColor","fontSize","CONTESTS","fetchContests","fetch","process","catch","Error","then","json","Promise","resolve","CONTEST_RESULTS_MAP","fetchContestResults","contest","startsWith","submissions","newGraphics","parent","Graphics","addChild","newText","y","font","t","PIXI","fontFamily","anchor","LABEL_FONT_FAMILY","RATING_FONT_FAMILY","OFFSET_X","STATUS_WIDTH","STATUS_HEIGHT","Particle","statusContainer","object","angle","speed","velocityX","velocityY","rotateSpeed","life","initialX","initialY","alpha","useStar","random","PI","cos","sin","visible","text","scale","rotation","Particles","particles","num","particle","disable","update","StatusCanvas","app","mode","borderGraphics","ratingText","placeText","diffText","dateText","contestNameText","standingsUrl","ticker","maxFPS","animate","destroy","children","texture","baseTexture","stage","OFFSET_Y","interactive","cursor","on","window","location","href","particle_flag","performance","old_rating","OldRating","place","contest_name","ContestName","tmp","clear","lineStyle","drawRoundedRect","toLocaleDateString","particleNum","floor","pow","pre","getRatingPer","StandingsUrl","PANEL_WIDTH","PANEL_HEIGHT","RatingDistributionChartCanvas","chartContainer","chartGraphics","labelTextStyle","yMax","lineGraphics","reduce","prev","curr","max","initBackground","initChart","panelGraphics","newLabelY","newLabelX","moveTo","lineTo","dropShadowFilter","DropShadowFilter","distance","hypot","atan2","blur","filters","countText","countGraphics","histogramGraphics","rectHeight","x0","x1","beginFill","drawRect","hitAreaRect","hitArea","mouseover","initUserRatingLine","col","per","getXandColor","RatingDistributionGraph","isFontListLoaded","useFontFaceObserver","family","chartCanvasRef","useRef","canvas","setCanvas","useEffect","chartCanvas","current","_chartApp","height","view","antialias","renderer","backgroundColor","_chartCanvas","init","margin","maxWidth","maxHeight","ref","MARGIN_VAL_X","MONTH_NAMES","ChartCanvas","x_min","x_max","y_min","y_max","R","ratingHistoryEntry","statusCanvas","min","getRating","y1","y2","endFill","month_step","isFirst","isEnded","j","unix","parse","statusGraphics","highestGraphics","mouseoverVertex","vertexGraphics","mouseoutVertex","highestIdx","argmax","maxRating","vertex","drawCircle","dx","HIGHEST_WIDTH","HIGHEST_HEIGHT","highest_text","RatingGraph","statusCanvasRef","canvases","setCanvases","_statusApp","_statusCanvas","lastHistory","ContentTab","ChartWrapper","ChartSection","activeTab","setActiveTab","tweetTitle","setTweetTitle","_tweetTitle","face","getDiffText","getHistogram","ButtonGroup","size","active","ratingDistribution","textAlign","TwitterShareButton","url","title","TwitterIcon","round","UncontrolledTooltip","placement","replaceAll","RatingColors","getRatingColor","getRatingColorBG","_sortCaret","order","marginLeft","faSortAmountDownAlt","opacity","faSort","HistoryTable","columns","dataField","formatter","cell","sortFunc","sortCaret","classes","_row","btnId","slug","rel","faSearch","reverse","bootstrap4","striped","keyField","filter","filterFactory","wrapperClasses","ContentWrapper","getNavClassName","RatingPage","params","chart","useSWR","contests","contestsError","error","promises","all","contestResultsArrayError","contestResult","Alert","marginBottom","tabs","faUser","table","faList","pageList","currPage","pageStartIndex","totalPages","start","end","pageNumbers","tmpExp","tmpPageNumber","unshift","PaginationPanel","renderSizePerPage","totalSize","sizePerPage","sizePerPageList","onSizePerPageChange","page","onPageChange","ceil","p","Pagination","flexWrap","justifyContent","pageNumber","PaginationItem","PaginationLink","TopcoderLikeCircle","fillRatio","big","styleOptions","metalColor","base","highlight","getRatingMetalColorCode","borderColor","background","colorCode","getRatingColorCode","getStyleOptions","RatingCircle","tooltipOpen","setTooltipOpen","toggleTooltipState","circleId","Badge","pill","Tooltip","toggle","faSortUp","faSortDown","RankingTable","ranking","headerClasses","textFilter","_a","_b","pagination","paginationFactory","custom","paginationProps","paginationTableProps","RankingPage","getRanking","App","revalidateOnFocus","Container","exact","path","component","padding","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9dfffbd7.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport { Button, ButtonGroup, UncontrolledTooltip } from 'reactstrap';\nimport { TwitterIcon, TwitterShareButton } from 'react-share';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { RatingRanks } from '../../utils/Rating';\nimport { RatingDistributionGraph } from './RatingDistributionGraph';\nimport { RatingGraph } from './RatingGraph';\nimport { getDiff, getOrdinal } from '../../utils';\n\ninterface Props {\n  paramUser: string;\n  ratingHistory?: RatingHistoryEntryEx[];\n  ratingRanks: RatingRanks;\n}\n\nenum ChartTab {\n  'rating' = 0,\n  'performance' = 1,\n  'ratingDistribution' = 2,\n}\n\nconst ChartWrapper: React.FC<{\n  display: boolean;\n}> = (props) => <>{props.display ? props.children : <></>}</>;\n\nconst getDiffText = (x: number): string => {\n  const face = x === 0 ? ':|' : x < 0 ? ':(' : ':)';\n  return `(${getDiff(x)}) ${face}`;\n};\n\nexport const ChartSection: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory, ratingRanks } = props;\n\n  const [activeTab, setActiveTab] = useState<ChartTab>(ChartTab.rating);\n  const [tweetTitle, setTweetTitle] = useState('');\n\n  useEffect(() => {\n    if (!ratingHistory) return;\n    const lastHistory = ratingHistory[ratingHistory.length - 1];\n    const rank = lastHistory.Place;\n    const _tweetTitle =\n      `${paramUser} took ${getOrdinal(rank)} place in ${\n        lastHistory.ContestName\n      }!\\n` +\n      `Performance: ${lastHistory.performance}\\n` +\n      `Rating: ${lastHistory.OldRating}→${lastHistory.NewRating} ${getDiffText(\n        lastHistory.NewRating - lastHistory.OldRating\n      )}\\n` +\n      `AtCoder Marathon Rating History`;\n    setTweetTitle(_tweetTitle);\n  }, [paramUser, ratingHistory]);\n\n  const [xaxis, data] = ratingRanks.getHistogram();\n  const rating = ratingRanks.getRating(paramUser);\n\n  return (\n    <>\n      <div style={{ marginTop: '20px' }}>\n        <ButtonGroup size=\"sm\" className=\"btn-group-ac-style\">\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.rating);\n            }}\n            active={activeTab === ChartTab.rating}\n          >\n            Rating\n          </Button>\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.performance);\n            }}\n            active={activeTab === ChartTab.performance}\n          >\n            Performance\n          </Button>\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.ratingDistribution);\n            }}\n            active={activeTab === ChartTab.ratingDistribution}\n          >\n            Rating Distribution\n          </Button>\n        </ButtonGroup>\n      </div>\n\n      <div style={{ marginTop: '20px' }}>\n        <ChartWrapper display={activeTab === ChartTab.rating}>\n          <RatingGraph\n            paramUser={paramUser}\n            ratingHistory={ratingHistory}\n            mode=\"Rating\"\n          />\n        </ChartWrapper>\n        <ChartWrapper display={activeTab === ChartTab.performance}>\n          <RatingGraph\n            paramUser={paramUser}\n            ratingHistory={ratingHistory}\n            mode=\"Performance\"\n          />\n        </ChartWrapper>\n        <ChartWrapper display={activeTab === ChartTab.ratingDistribution}>\n          <RatingDistributionGraph xaxis={xaxis} data={data} rating={rating} />\n        </ChartWrapper>\n      </div>\n      <div style={{ textAlign: 'center', marginTop: '30px' }}>\n        <TwitterShareButton\n          url={window.location.href}\n          title={tweetTitle}\n          id=\"chart-share-button\"\n        >\n          <TwitterIcon size={40} round />\n        </TwitterShareButton>\n        <UncontrolledTooltip placement=\"top\" target=\"chart-share-button\">\n          {(tweetTitle + ' ' + window.location.href).replaceAll('\\n', ' ')}\n        </UncontrolledTooltip>\n      </div>\n    </>\n  );\n};\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n  Collapse,\n  Nav,\n  Navbar,\n  NavLink,\n  NavbarBrand,\n  NavbarToggler,\n  NavItem,\n} from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChartLine,\n  faSortAmountDown,\n} from '@fortawesome/free-solid-svg-icons';\n\nexport const NavigationBar: React.FC = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const toggle = () => setIsOpen(!isOpen);\n\n  return (\n    <Navbar color=\"light\" light expand=\"md\" fixed=\"top\">\n      <NavbarBrand tag={Link} to={'/'}>\n        AtCoder Marathon Rating History\n      </NavbarBrand>\n      <NavbarToggler onClick={toggle} />\n      <Collapse isOpen={isOpen} navbar>\n        <Nav className=\"mr-auto\" navbar>\n          <NavItem>\n            <NavLink tag={Link} to=\"/rating/\">\n              <FontAwesomeIcon\n                style={{ marginRight: '4px' }}\n                icon={faChartLine}\n              />\n              Rating\n            </NavLink>\n          </NavItem>\n          <NavItem>\n            <NavLink tag={Link} to=\"/ranking/\">\n              <FontAwesomeIcon\n                style={{ marginRight: '4px' }}\n                icon={faSortAmountDown}\n              />\n              Ranking\n            </NavLink>\n          </NavItem>\n        </Nav>\n      </Collapse>\n    </Navbar>\n  );\n};\n","import React, { useState, useMemo } from 'react';\nimport { NavLink, useHistory } from 'react-router-dom';\nimport { Button, Input, Row, FormGroup, Label, Col } from 'reactstrap';\n\ninterface Props {\n  paramUser: string;\n}\n\nconst generatePath = (user: string): string => `/rating/${user}`;\n\nexport const FormBlock: React.FC<Props> = (props) => {\n  const { paramUser } = props;\n  const [user, setUser] = useState(paramUser);\n  const ratingPagePath = useMemo(() => generatePath(user), [user]);\n  const history = useHistory();\n\n  return (\n    <>\n      <Row>\n        <Col sm={12}>\n          <FormGroup style={{ width: '100%' }}>\n            <Label for=\"input-user\">ATCODER ID:</Label>\n            <Input\n              value={user}\n              type=\"text\"\n              name=\"input-user\"\n              id=\"input-user\"\n              placeholder={user ? user : 'eivour'}\n              onChange={(e): void => setUser(e.target.value)}\n              onKeyPress={(e): void => {\n                if (e.key === 'Enter') {\n                  history.push(ratingPagePath);\n                }\n              }}\n            />\n          </FormGroup>\n        </Col>\n      </Row>\n      <Row>\n        <Col sm={12}>\n          <Button\n            color=\"primary\"\n            tag={NavLink}\n            to={ratingPagePath}\n            block\n            style={{ display: 'block', marginTop: '0.5rem' }}\n          >\n            Go\n          </Button>\n        </Col>\n      </Row>\n    </>\n  );\n};\n","const pad = (n: number): string => {\n  return `0${n}`.slice(-2);\n};\n\n/**\n * 順位の数値から順位文字列に変換する\n * @param x 順位\n * @returns 順位文字列\n */\nexport const getOrdinal = (x: number): string => {\n  const s = ['th', 'st', 'nd', 'rd'];\n  const v = x % 100;\n  return `${x}${s[(v - 20) % 10] || s[v] || s[0]}`;\n};\n\nexport const formatDate = (d: Date): string => {\n  const year = String(d.getFullYear());\n  const month = pad(d.getMonth() + 1);\n  const date = pad(d.getDate());\n  return `${year}/${month}/${date}`;\n};\n\nconst DAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'] as const;\n\n// 2021-08-14(Sat) 22:40\nexport const formatDatetime = (d: Date): string => {\n  const year = String(d.getFullYear());\n  const month = pad(d.getMonth() + 1);\n  const date = pad(d.getDate());\n  const day = DAYS[d.getDay()];\n  const hours = pad(d.getHours());\n  const minutes = pad(d.getMinutes());\n  return `${year}-${month}-${date}(${day}) ${hours}:${minutes}`;\n};\n\nexport const getPer = (x: number, l: number, r: number): number => {\n  return (x - l) / (r - l);\n};\n\n/**\n * returns array [start, start+1, ..., end].\n *\n * @param {number} start start number\n * @param {number} end end number\n * @returns {number[]} array\n */\nexport const range = (start: number, end: number): number[] =>\n  Array.from({ length: end - start + 1 }, (v, k) => k + start);\n\n/**\n * 増減値を文字列に変換する\n * @param x 増減値\n * @returns 増減値を表す文字列\n */\nexport const getDiff = (x: number): string => {\n  const sign = x === 0 ? '±' : x < 0 ? '-' : '+';\n  return `${sign}${Math.abs(x)}`;\n};\n","export class BinaryIndexedTree {\n  data: number[];\n  length: number;\n  constructor(_length: number) {\n    this.length = _length;\n    this.data = (Array(++_length) as number[]).fill(0);\n  }\n  sum(k: number): number {\n    let ret = 0;\n    for (++k; k > 0; k -= k & -k) ret += this.data[k];\n    return ret;\n  }\n  add(k: number, x: number): void {\n    for (++k; k < this.data.length; k += k & -k) this.data[k] += x;\n  }\n  // query for [l, r)\n  query(l: number, r: number): number {\n    return this.sum(r - 1) - this.sum(l - 1);\n  }\n}\n","import { BinaryIndexedTree } from './BinaryIndexedTree';\nimport { ContestResults } from './Data';\n\nexport const STEP_SIZE = 400;\nexport const COLORS: [number, string, number, number][] = [\n  [0, '#808080', 0.15, 0x808080],\n  [400, '#804000', 0.15, 0x804000],\n  [800, '#008000', 0.15, 0x008000],\n  [1200, '#00C0C0', 0.2, 0x00c0c0],\n  [1600, '#0000FF', 0.1, 0x0000ff],\n  [2000, '#C0C000', 0.25, 0xc0c000],\n  [2400, '#FF8000', 0.2, 0xff8000],\n  [2800, '#FF0000', 0.1, 0xff0000],\n];\n\n/**\n * レーティング x に関する色情報を返す\n * @param x レーティング\n * @returns [レーティング下限値，色文字列，アルファ値，色数値]\n */\nexport const getColor = (x: number): [number, string, number, number] => {\n  for (let i = COLORS.length - 1; i >= 0; i--) {\n    if (x >= COLORS[i][0]) return COLORS[i];\n  }\n  return [-1, '#000000', 0.1, 0x000000];\n};\n\n/**\n * 同色レーティング帯のうち何割の位置にいるかを求める\n * @param x レーティング値\n * @returns 割合\n */\nexport const getRatingPer = (x: number): number => {\n  let pre = COLORS[COLORS.length - 1][0] + STEP_SIZE;\n  for (let i = COLORS.length - 1; i >= 0; i--) {\n    if (x >= COLORS[i][0]) return (x - COLORS[i][0]) / (pre - COLORS[i][0]);\n    pre = COLORS[i][0];\n  }\n  return 0;\n};\n\nexport interface RankingEntry {\n  rank: number;\n  rating: number;\n  username: string;\n  win: number;\n  match: number;\n}\n\nconst MAX_RATING = 10000;\nexport class RatingRanks {\n  bit: BinaryIndexedTree;\n  user2rating: Map<string, RankingEntry>;\n  // userid => [rating, rank][]\n  user2ratingRankHistory: Map<string, [number, number][]>;\n  ratings: number[];\n\n  constructor(contestResultsArray?: (ContestResults | undefined)[]) {\n    this.bit = new BinaryIndexedTree(MAX_RATING);\n    this.user2rating = new Map<string, RankingEntry>();\n    this.user2ratingRankHistory = new Map<string, [number, number][]>();\n    if (contestResultsArray === undefined) {\n      this.ratings = [];\n      return;\n    }\n    contestResultsArray.forEach((contestResults) => {\n      if (contestResults === undefined) return;\n\n      // レーティング更新の反映\n      for (const username in contestResults) {\n        const rankingEntry = this.user2rating.get(username);\n        if (rankingEntry !== undefined) {\n          const oldRating = rankingEntry.rating;\n          rankingEntry.rating = contestResults[username].NewRating;\n          rankingEntry.match++;\n          if (contestResults[username].Place === 1) {\n            rankingEntry.win++;\n          }\n          this.bit.add(oldRating, -1);\n          this.bit.add(contestResults[username].NewRating, 1);\n        } else {\n          this.user2rating.set(username, {\n            rank: -1,\n            rating: contestResults[username].NewRating,\n            username,\n            win: contestResults[username].Place === 1 ? 1 : 0,\n            match: 1,\n          });\n          this.bit.add(contestResults[username].NewRating, 1);\n        }\n      }\n\n      // ランキング更新\n      this.user2rating.forEach(\n        (rankingEntry: RankingEntry, username: string) => {\n          const rank = this.bit.query(rankingEntry.rating + 1, MAX_RATING) + 1;\n          rankingEntry.rank = rank;\n          if (this.user2ratingRankHistory.has(username)) {\n            this.user2ratingRankHistory\n              .get(username)\n              ?.push([rankingEntry.rating, rank]);\n          } else {\n            this.user2ratingRankHistory.set(username, [\n              [rankingEntry.rating, rank],\n            ]);\n          }\n        }\n      );\n    });\n    // dump\n    const aaa = [] as number[];\n    for (let i = 0; i < 4000; ++i) {\n      aaa.push(this.bit.query(i, i + 1));\n    }\n    console.log(aaa);\n    this.ratings = Array.from(this.user2rating.values()).map(\n      (rankingEntry) => rankingEntry.rating\n    );\n    this.ratings.sort((a, b) => b - a);\n  }\n\n  getRank(username: string): number {\n    const ratingAndRank = this.user2ratingRankHistory.get(username);\n    if (ratingAndRank === undefined) return -1;\n    return ratingAndRank[ratingAndRank.length - 1][1];\n  }\n\n  getRating(username: string): number {\n    return this.user2rating.get(username)?.rating ?? 0;\n  }\n\n  getHistogram(): [number[], number[]] {\n    const xaxis = [\n      0, 1, 2, 3, 4, 5, 7, 9, 12, 15, 19, 25, 32, 42, 54, 69, 89, 114, 147, 188,\n      242, 311, 400,\n    ];\n    // 400 以降は 100 区切りで 10000 まで追加しておく\n    for (let x = 500; x < 10000; x += 100) {\n      xaxis.push(x);\n    }\n    const data = Array(xaxis.length) as number[];\n    data.fill(0);\n\n    // 区切りごとに個数を数える\n    this.ratings.forEach((rating) => {\n      const index: number = xaxis.findIndex(\n        (x, i) => x <= rating && rating < xaxis[i + 1]\n      );\n      if (index === -1) return;\n      data[index]++;\n    });\n\n    // 0 要素を後ろから削る\n    while (data[data.length - 1] === 0) {\n      data.pop();\n      xaxis.pop();\n    }\n    return [xaxis, data];\n  }\n\n  /** get {rank, rating, username, win, match}[] */\n  getRanking(): RankingEntry[] {\n    const ratingAndUsername = Array.from(this.user2rating.values());\n    ratingAndUsername.sort((a, b) => {\n      if (a.rating != b.rating) return b.rating - a.rating;\n      else if (a.username < b.username) return -1;\n      else return 1;\n    });\n    return ratingAndUsername;\n  }\n}\n","import React from 'react';\nimport { RatingHistoryEntry } from '../../interfaces/RatingHistoryEntry';\nimport { formatDate, getOrdinal } from '../../utils';\nimport { getColor, RatingRanks } from '../../utils/Rating';\n\ninterface Props {\n  paramUser: string;\n  ratingHistory: RatingHistoryEntry[];\n  ratingRanks: RatingRanks;\n}\n\nexport const UserInfoTable: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory, ratingRanks } = props;\n  if (ratingHistory.length === 0) {\n    return <></>;\n  }\n  const lastResult = ratingHistory[ratingHistory.length - 1];\n  const lastCompeted = new Date(lastResult.EndTime * 1000);\n  const rank = ratingRanks.getRank(paramUser);\n  const ratingColor = getColor(lastResult.NewRating)[1];\n\n  return (\n    <>\n      <h3 style={{ fontSize: '24px' }}>Contest Status</h3>\n      <hr />\n      <table className=\"dl-table\" style={{ fontSize: '14px' }}>\n        <tr>\n          <th className=\"no-break\">Name</th>\n          <td>{paramUser}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rank</th>\n          <td>{getOrdinal(rank)}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rating</th>\n          <td>\n            <span style={{ color: ratingColor }}>{lastResult.NewRating}</span>\n          </td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rated Matches</th>\n          <td>{ratingHistory.length}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Last Competed</th>\n          <td>{formatDate(lastCompeted)}</td>\n        </tr>\n      </table>\n    </>\n  );\n};\n","import { Contest } from '../interfaces/Contest';\nimport { RatingHistoryEntryEx } from '../interfaces/RatingHistoryEntry';\n\nlet CONTESTS: Contest[] | undefined = undefined;\nexport const fetchContests = async (): Promise<Contest[]> =>\n  CONTESTS === undefined\n    ? fetch(`${process.env.PUBLIC_URL}/json/contests/contests.json`)\n        .catch((e) => {\n          throw Error(e);\n        })\n        .then(async (r) => {\n          CONTESTS = (await r.json()) as Contest[];\n          return CONTESTS;\n        })\n    : Promise.resolve(CONTESTS);\n\nexport type ContestResults = { [key: string]: RatingHistoryEntryEx };\nconst CONTEST_RESULTS_MAP: Map<string, ContestResults> = new Map<\n  string,\n  ContestResults\n>();\nexport const fetchContestResults = async (\n  contest?: string\n): Promise<ContestResults | undefined> =>\n  contest !== undefined && contest.length > 0 && contest.startsWith('ahc')\n    ? !CONTEST_RESULTS_MAP.has(contest)\n      ? fetch(`${process.env.PUBLIC_URL}/json/results/${contest}.json`)\n          .catch((e) => {\n            throw Error(e);\n          })\n          .then(async (r) => {\n            const submissions = (await r.json()) as ContestResults;\n            CONTEST_RESULTS_MAP.set(contest, submissions);\n            return submissions;\n          })\n      : Promise.resolve(CONTEST_RESULTS_MAP.get(contest) as ContestResults)\n    : Promise.resolve(undefined);\n","import * as PIXI from 'pixi.js';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\n\nexport const newGraphics = (\n  parent: PIXI.Graphics | PIXI.Container\n): Graphics => {\n  const s = new Graphics();\n  parent.addChild(s);\n  return s;\n};\n\nexport const newText = (\n  parent: PIXI.Container,\n  x: number,\n  y: number,\n  font: string,\n  fontSize: number\n): PIXI.Text => {\n  const t = new PIXI.Text(\n    '',\n    new PIXI.TextStyle({\n      fontFamily: font,\n      fontSize: fontSize,\n      fill: 0x000000,\n    })\n  );\n  t.x = x;\n  t.y = y;\n  t.anchor.x = 0.5;\n  t.anchor.y = 0.5;\n  parent.addChild(t);\n  return t;\n};\n","import * as PIXI from 'pixi.js';\nimport { newGraphics, newText } from '../../utils/Shape';\nimport { getColor, getRatingPer } from '../../utils/Rating';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { getDiff, getOrdinal } from '../../utils';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\nimport { ChartCanvasMode } from './ChartCanvas';\n\nexport const LABEL_FONT_FAMILY = 'Lato';\nexport const RATING_FONT_FAMILY = 'Squada One';\n\nconst OFFSET_X = 50;\nconst OFFSET_Y = 5;\nconst STATUS_WIDTH = 640 - OFFSET_X - 10;\nconst STATUS_HEIGHT = 80 - OFFSET_Y - 5;\n\nconst STAR_MIN = 3200;\nconst PARTICLE_MIN = 3;\nconst PARTICLE_MAX = 20;\nconst LIFE_MAX = 30;\n\nclass Particle {\n  object: PIXI.Text;\n  angle: number;\n  speed: number;\n  velocityX: number;\n  velocityY: number;\n  rotateSpeed: number;\n  life: number;\n  initialX: number;\n  initialY: number;\n\n  constructor(statusContainer: PIXI.Container, x: number, y: number) {\n    this.initialX = x;\n    this.initialY = y;\n    this.object = newText(statusContainer, 0, 0, LABEL_FONT_FAMILY, 64);\n    this.angle = 0;\n    this.speed = 0;\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.rotateSpeed = 0;\n    this.life = 0;\n    this.object.x = this.initialX;\n    this.object.y = this.initialY;\n  }\n\n  set(color: number, alpha: number, useStar: boolean) {\n    this.object.x = this.initialX;\n    this.object.y = this.initialY;\n    this.angle = Math.random() * Math.PI * 2;\n    this.speed = Math.random() * 4 + 4;\n    this.velocityX = Math.cos(this.angle) * this.speed;\n    this.velocityY = Math.sin(this.angle) * this.speed;\n    this.rotateSpeed = Math.random() * 20 + 10;\n    this.life = LIFE_MAX;\n    this.object.visible = true;\n    this.object.style.fill = color;\n    this.object.text = useStar ? '★' : '@';\n    this.object.alpha = alpha;\n  }\n\n  disable() {\n    this.life = 0;\n    this.object.visible = false;\n  }\n\n  update() {\n    if (this.life <= 0) {\n      this.object.visible = false;\n      return;\n    }\n    this.object.x += this.velocityX;\n    this.velocityX *= 0.9;\n    this.object.y += this.velocityY;\n    this.velocityY *= 0.9;\n    this.life--;\n    this.object.scale.x = this.object.scale.y = this.life / LIFE_MAX;\n    this.object.rotation += this.rotateSpeed;\n  }\n}\n\nclass Particles {\n  particles: Particle[];\n\n  constructor(statusContainer: PIXI.Container, x: number, y: number) {\n    this.particles = [];\n    for (let i = 0; i < PARTICLE_MAX; ++i) {\n      this.particles.push(new Particle(statusContainer, x, y));\n    }\n  }\n\n  set(num: number, color: number, alpha: number, rating: number) {\n    const useStar = rating >= STAR_MIN;\n    this.particles.forEach((particle, index) => {\n      if (index < num) {\n        particle.set(color, alpha, useStar);\n      } else {\n        particle.disable();\n      }\n    });\n  }\n\n  update() {\n    this.particles.forEach((particle) => {\n      if (particle.life > 0) {\n        particle.update();\n      }\n    });\n  }\n}\n\nexport class StatusCanvas {\n  app: PIXI.Application;\n  statusContainer?: PIXI.Container;\n  borderGraphics!: Graphics;\n  ratingText!: PIXI.Text;\n  placeText!: PIXI.Text;\n  diffText!: PIXI.Text;\n  dateText!: PIXI.Text;\n  contestNameText!: PIXI.Text;\n\n  particles?: Particles;\n  standingsUrl: string;\n\n  mode: ChartCanvasMode;\n\n  constructor(app: PIXI.Application, mode: ChartCanvasMode) {\n    this.app = app;\n    this.statusContainer = undefined;\n    this.standingsUrl = '';\n    this.mode = mode;\n\n    this.app.ticker.maxFPS = 60;\n    this.app.ticker.add(() => {\n      this.animate();\n    });\n  }\n\n  destroy(): void {\n    if (this.statusContainer) {\n      this.statusContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.statusContainer = undefined;\n    }\n  }\n\n  init(): void {\n    this.destroy();\n    this.statusContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.statusContainer);\n\n    this.borderGraphics = newGraphics(this.statusContainer);\n    this.ratingText = newText(\n      this.statusContainer,\n      OFFSET_X + 75,\n      OFFSET_Y + STATUS_HEIGHT / 2,\n      RATING_FONT_FAMILY,\n      48\n    );\n    this.placeText = newText(\n      this.statusContainer,\n      OFFSET_X + 160,\n      OFFSET_Y + STATUS_HEIGHT / 2.7,\n      LABEL_FONT_FAMILY,\n      16\n    );\n    this.diffText = newText(\n      this.statusContainer,\n      OFFSET_X + 160,\n      OFFSET_Y + STATUS_HEIGHT / 1.5,\n      LABEL_FONT_FAMILY,\n      11\n    );\n    this.diffText.style.fill = 0x888888;\n    this.dateText = newText(\n      this.statusContainer,\n      OFFSET_X + 200,\n      OFFSET_Y + STATUS_HEIGHT / 4,\n      LABEL_FONT_FAMILY,\n      14\n    );\n    this.contestNameText = newText(\n      this.statusContainer,\n      OFFSET_X + 200,\n      OFFSET_Y + STATUS_HEIGHT / 1.6,\n      LABEL_FONT_FAMILY,\n      20\n    );\n    this.dateText.anchor.x = 0.0;\n    this.contestNameText.anchor.x = 0.0;\n    if (this.contestNameText.width > STATUS_WIDTH - 200 - 10) {\n      this.contestNameText.scale.x =\n        (STATUS_WIDTH - 200 - 10) / this.contestNameText.width;\n    }\n\n    this.contestNameText.interactive = true;\n    this.contestNameText.cursor = 'pointer';\n    this.contestNameText.on('click', () => {\n      window.location.href = this.standingsUrl;\n    });\n\n    this.particles = new Particles(\n      this.statusContainer,\n      this.ratingText.x,\n      this.ratingText.y\n    );\n  }\n\n  set(data: RatingHistoryEntryEx, particle_flag: boolean): void {\n    if (!this.particles) return;\n    const date = new Date(data.EndTime * 1000);\n    const rating = this.mode === 'Rating' ? data.NewRating : data.performance;\n    const old_rating: number | null =\n      this.mode === 'Rating' ? data.OldRating : null;\n    const place = data.Place;\n    const contest_name = data.ContestName;\n    const tmp = getColor(rating);\n    const color = tmp[3],\n      alpha = tmp[2];\n    this.borderGraphics\n      .clear()\n      .lineStyle(1.0, color)\n      .drawRoundedRect(OFFSET_X, OFFSET_Y, STATUS_WIDTH, STATUS_HEIGHT, 2);\n    this.ratingText.text = String(rating);\n    this.ratingText.style.fill = color;\n    this.placeText.text = getOrdinal(place);\n    this.diffText.text =\n      old_rating !== null ? getDiff(rating - old_rating) : '-';\n    this.dateText.text = date.toLocaleDateString();\n    this.contestNameText.text = contest_name;\n    this.contestNameText.scale.x = 1.0;\n    if (this.contestNameText.width > STATUS_WIDTH - 200 - 10) {\n      this.contestNameText.scale.x =\n        (STATUS_WIDTH - 200 - 10) / this.contestNameText.width;\n    }\n    if (particle_flag) {\n      const particleNum = Math.floor(\n        Math.pow(getRatingPer(rating), 2) * (PARTICLE_MAX - PARTICLE_MIN) +\n          PARTICLE_MIN\n      );\n      this.particles.set(particleNum, color, alpha, rating);\n    }\n    this.standingsUrl = data.StandingsUrl;\n  }\n\n  animate(): void {\n    if (!this.particles) return;\n    this.particles.update();\n  }\n}\n","import * as PIXI from 'pixi.js';\nimport { DropShadowFilter } from '@pixi/filter-drop-shadow';\nimport { getPer } from '../../utils';\nimport { newGraphics } from '../../utils/Shape';\nimport { getColor } from '../../utils/Rating';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\n\nconst OFFSET_X = 40;\nconst OFFSET_Y = 20;\nconst MARGIN_Y_PER = 1.1;\nconst STEP = 20;\nconst PANEL_WIDTH = 640 - OFFSET_X - 12;\nconst PANEL_HEIGHT = 480 - OFFSET_Y - 30;\n\n// additional\nconst LABEL_FONT_FAMILY = 'Lato';\n\nexport class RatingDistributionChartCanvas {\n  app: PIXI.Application;\n  chartContainer?: PIXI.Container;\n  chartGraphics?: Graphics;\n  labelTextStyle!: PIXI.TextStyle;\n\n  n!: number;\n  xaxis!: number[];\n  data!: number[];\n  rating!: number;\n\n  yMax!: number;\n\n  lineGraphics?: Graphics;\n  ratingText?: PIXI.Text;\n\n  constructor(app: PIXI.Application) {\n    this.app = app;\n    this.chartContainer = undefined;\n    // void this.init();\n  }\n\n  destroy(): void {\n    if (this.chartContainer) {\n      this.chartContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.chartContainer = undefined;\n    }\n  }\n\n  init(xaxis: number[], data: number[], rating: number): void {\n    this.destroy();\n    this.chartContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.chartContainer);\n\n    if (data.length !== xaxis.length) {\n      throw new Error('長さ不一致');\n    }\n    this.xaxis = xaxis;\n    this.data = data;\n    this.rating = rating;\n\n    this.n = data.length;\n    if (this.n == 0) return;\n    this.xaxis.push(this.xaxis[this.n - 1] + 100);\n\n    this.yMax =\n      this.data.reduce((prev, curr) => Math.max(prev, curr), 0) * MARGIN_Y_PER;\n\n    this.labelTextStyle = new PIXI.TextStyle({\n      fontFamily: LABEL_FONT_FAMILY,\n      fontSize: 12,\n      fill: 0x000000,\n    });\n\n    void this.initBackground();\n    void this.initChart();\n  }\n\n  initBackground(): void {\n    if (this.chartContainer === undefined) return;\n\n    const panelGraphics = newGraphics(this.chartContainer);\n    panelGraphics.x = OFFSET_X;\n    panelGraphics.y = OFFSET_Y;\n    panelGraphics.alpha = 0.3;\n    const borderGraphics = newGraphics(this.chartContainer);\n    borderGraphics.x = OFFSET_X;\n    borderGraphics.y = OFFSET_Y;\n\n    const newLabelY = (s: string, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = OFFSET_X - 10;\n      t.y = OFFSET_Y + y;\n      t.anchor.x = 1.0;\n      t.anchor.y = 0.5;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    const newLabelX = (s: string, x: number): PIXI.Text => {\n      const t = new PIXI.Text(\n        s,\n        new PIXI.TextStyle({\n          fontFamily: LABEL_FONT_FAMILY,\n          fontSize: 10,\n          fill: 0x000000,\n        })\n      );\n      t.x = OFFSET_X + x;\n      t.y = OFFSET_Y + PANEL_HEIGHT + 3;\n      t.anchor.x = 0.0;\n      t.anchor.y = 0.5;\n      t.angle = 90;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    // y 軸ラベルとグリッド線を追加する\n    borderGraphics.lineStyle(1.0, 0xdddddd);\n    for (let i = STEP; i < this.yMax; i += STEP) {\n      const y = PANEL_HEIGHT - PANEL_HEIGHT * getPer(i, 0, this.yMax);\n      borderGraphics.moveTo(0, y).lineTo(PANEL_WIDTH, y);\n      newLabelY(String(i), y);\n    }\n\n    // x 軸ラベルを追加する\n    for (let i = 0; i < this.n; i += 2) {\n      const x = PANEL_WIDTH * getPer(i, 0, this.n);\n      newLabelX(String(this.xaxis[i]), x);\n    }\n\n    borderGraphics\n      .lineStyle(1.5, 0x888888)\n      .drawRoundedRect(0, 0, PANEL_WIDTH, PANEL_HEIGHT, 2);\n  }\n\n  newText(\n    parent: Graphics,\n    x: number,\n    y: number,\n    font: PIXI.TextStyle\n  ): PIXI.Text {\n    const t = new PIXI.Text('', font);\n    t.x = x;\n    t.y = y;\n    t.anchor.x = 0.5;\n    t.anchor.y = 0.5;\n    parent.addChild(t);\n    return t;\n  }\n\n  initChart(): void {\n    if (this.chartContainer === undefined) return;\n\n    this.chartGraphics = newGraphics(this.chartContainer);\n    const dropShadowFilter = new DropShadowFilter();\n    dropShadowFilter.color = 0x000000;\n    dropShadowFilter.alpha = 0.3;\n    dropShadowFilter.distance = Math.hypot(1, 2);\n    dropShadowFilter.angle = Math.atan2(1, 2);\n    dropShadowFilter.blur = 3;\n    this.chartGraphics.filters = [dropShadowFilter];\n\n    // マウスオーバー時に表示する線と数字を用意する\n    const countText = this.newText(\n      this.chartGraphics,\n      0,\n      0,\n      new PIXI.TextStyle({\n        fontFamily: LABEL_FONT_FAMILY,\n        fontSize: 10,\n        fill: 0x000000,\n      })\n    );\n    countText.visible = false;\n    const countGraphics = newGraphics(this.chartContainer);\n    countGraphics\n      .lineStyle(1.0, 0xdddddd)\n      .moveTo(0, 20)\n      .lineTo(0, PANEL_HEIGHT);\n    countGraphics.y = OFFSET_Y;\n    countGraphics.visible = false;\n    const mouseover = (i: number): void => {\n      const x = OFFSET_X + PANEL_WIDTH * getPer(i + 0.5, 0, this.n);\n      countText.text = `${this.data[i]}`;\n      countText.style.fill = getColor(this.xaxis[i])[1];\n      countText.x = x;\n      countText.y = OFFSET_Y + 10;\n      countGraphics.x = x;\n      countText.visible = true;\n      countGraphics.visible = true;\n    };\n    const mouseout = (): void => {\n      countText.visible = false;\n      countGraphics.visible = false;\n    };\n\n    // ヒストグラム本体を描画する\n    for (let i = 0; i < this.n; ++i) {\n      const histogramGraphics = newGraphics(this.chartGraphics);\n\n      const rectHeight = PANEL_HEIGHT * getPer(this.data[i], 0, this.yMax);\n\n      const x0 = Math.floor(OFFSET_X + PANEL_WIDTH * getPer(i, 0, this.n));\n      const x1 = Math.floor(OFFSET_X + PANEL_WIDTH * getPer(i + 1, 0, this.n));\n      histogramGraphics.x = x0;\n      histogramGraphics.y = OFFSET_Y + PANEL_HEIGHT - rectHeight;\n      histogramGraphics\n        .lineStyle(0.5, 0xffffff)\n        .beginFill(getColor(this.xaxis[i])[3])\n        .drawRect(0, 0, x1 - x0 - 1, rectHeight);\n\n      const hitAreaRect = new PIXI.Rectangle(\n        0,\n        +rectHeight - PANEL_HEIGHT,\n        PANEL_WIDTH / this.n,\n        PANEL_HEIGHT\n      );\n      histogramGraphics.hitArea = hitAreaRect;\n      histogramGraphics.interactive = true;\n      histogramGraphics.on('mouseover', () => {\n        mouseover(i);\n      });\n      histogramGraphics.on('mouseout', () => {\n        mouseout();\n      });\n    }\n\n    // ユーザのレーティングを表す線を描画する\n    void this.initUserRatingLine(this.rating);\n  }\n\n  getXandColor(rating: number): [number, number] {\n    let x = PANEL_WIDTH;\n    let col = 0x000000;\n    for (let i = this.n - 1; i >= 0; i--) {\n      if (this.xaxis[i] <= rating) {\n        const per = getPer(rating + 0.5, this.xaxis[i], this.xaxis[i + 1]);\n        x = PANEL_WIDTH * getPer(i + per, 0, this.n);\n        col = getColor(this.xaxis[i])[3];\n        break;\n      }\n    }\n    return [x, col];\n  }\n\n  initUserRatingLine(rating: number): void {\n    if (this.chartContainer === undefined) return;\n    if (this.chartGraphics === undefined) return;\n\n    const [x, col] = this.getXandColor(rating);\n    this.lineGraphics = newGraphics(this.chartContainer);\n    this.lineGraphics\n      .lineStyle(1.0, 0x000000)\n      .moveTo(0, 0)\n      .lineTo(0, PANEL_HEIGHT);\n    this.lineGraphics.x = OFFSET_X + x;\n    this.lineGraphics.y = OFFSET_Y;\n    this.ratingText = this.newText(\n      this.chartGraphics,\n      OFFSET_X + x,\n      12,\n      new PIXI.TextStyle({\n        fontFamily: LABEL_FONT_FAMILY,\n        fontSize: 11,\n        fill: col,\n      })\n    );\n    this.ratingText.text = String(rating);\n  }\n\n  updateUserRatingLine(rating: number): void {\n    this.rating = rating;\n    if (this.lineGraphics === undefined) return;\n    if (this.ratingText === undefined) return;\n\n    this.lineGraphics.x = OFFSET_X + this.getXandColor(rating)[0];\n    this.ratingText.text = String(rating);\n  }\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport useFontFaceObserver from 'use-font-face-observer';\nimport * as PIXI from 'pixi.js';\nimport { LABEL_FONT_FAMILY, RATING_FONT_FAMILY } from './StatusCanvas';\nimport { RatingDistributionChartCanvas } from './RatingDistributionChartCanvas';\n\ninterface Props {\n  xaxis: number[];\n  data: number[];\n  rating: number;\n}\n\nexport const RatingDistributionGraph: React.FC<Props> = (props) => {\n  const { xaxis, data, rating } = props;\n  const isFontListLoaded = useFontFaceObserver([\n    { family: RATING_FONT_FAMILY },\n    { family: LABEL_FONT_FAMILY },\n  ]);\n  const chartCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const [canvas, setCanvas] = useState<RatingDistributionChartCanvas>();\n\n  useEffect(() => {\n    const chartCanvas: HTMLCanvasElement | null = chartCanvasRef.current;\n    if (chartCanvas === null) return;\n\n    const _chartApp = new PIXI.Application({\n      width: 640,\n      height: 480,\n      view: chartCanvas,\n      antialias: true,\n    });\n    _chartApp.renderer.backgroundColor = 0xffffff;\n\n    const _chartCanvas = new RatingDistributionChartCanvas(_chartApp);\n    setCanvas(_chartCanvas);\n  }, []);\n\n  useEffect(() => {\n    if (!isFontListLoaded) return;\n    if (!data) return;\n    if (!canvas) return;\n\n    if (data.length === 0) {\n      canvas.destroy();\n      return;\n    }\n    canvas.init(xaxis, data, rating);\n  }, [isFontListLoaded, data, canvas]);\n\n  return (\n    <>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '480px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={chartCanvasRef}\n          width=\"640\"\n          height=\"480\"\n        ></canvas>\n      </div>\n    </>\n  );\n};\n","import * as PIXI from 'pixi.js';\nimport { DropShadowFilter } from '@pixi/filter-drop-shadow';\nimport { StatusCanvas } from './StatusCanvas';\nimport { getPer } from '../../utils';\nimport { newGraphics } from '../../utils/Shape';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\nimport { COLORS, STEP_SIZE, getColor } from '../../utils/Rating';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\n\nconst MARGIN_VAL_X = 86400 * 30;\nconst MARGIN_VAL_Y_LOW = 100;\nconst MARGIN_VAL_Y_HIGH = 300;\nconst OFFSET_X = 50;\nconst OFFSET_Y = 5;\nconst PANEL_WIDTH = 640 - OFFSET_X - 10;\nconst PANEL_HEIGHT = 360 - OFFSET_Y - 30;\nconst HIGHEST_WIDTH = 80;\nconst HIGHEST_HEIGHT = 20;\nconst START_YEAR = 2010;\nconst MONTH_NAMES = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n];\nconst YEAR_SEC = 86400 * 365;\n\n// additional\nconst LABEL_FONT_FAMILY = 'Lato';\n\nconst MODES = ['Rating', 'Performance'] as const;\nexport type ChartCanvasMode = typeof MODES[number];\n\nexport class ChartCanvas {\n  app: PIXI.Application;\n  chartContainer?: PIXI.Container;\n  x_min!: number;\n  x_max!: number;\n  y_min!: number;\n  y_max!: number;\n  labelTextStyle!: PIXI.TextStyle;\n  R!: number;\n  mode: ChartCanvasMode;\n\n  constructor(app: PIXI.Application, mode: ChartCanvasMode) {\n    this.app = app;\n    this.chartContainer = undefined;\n    this.mode = mode;\n    // void this.init();\n  }\n\n  destroy(): void {\n    if (this.chartContainer) {\n      this.chartContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.chartContainer = undefined;\n    }\n  }\n\n  getRating(ratingHistoryEntry: RatingHistoryEntryEx): number {\n    if (this.mode === 'Rating') return ratingHistoryEntry.NewRating;\n    else return ratingHistoryEntry.performance;\n  }\n\n  init(\n    ratingHistory: RatingHistoryEntryEx[],\n    statusCanvas: StatusCanvas\n  ): void {\n    this.destroy();\n    this.chartContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.chartContainer);\n\n    this.R = 1.0;\n\n    this.x_min = 100000000000;\n    this.x_max = 0;\n    this.y_min = 10000;\n    this.y_max = 0;\n    ratingHistory.forEach((ratingHistoryEntry) => {\n      this.x_min = Math.min(this.x_min, ratingHistoryEntry.EndTime);\n      this.x_max = Math.max(this.x_max, ratingHistoryEntry.EndTime);\n      const rating = this.getRating(ratingHistoryEntry);\n      this.y_min = Math.min(this.y_min, rating);\n      this.y_max = Math.max(this.y_max, rating);\n    });\n    this.x_min -= MARGIN_VAL_X;\n    this.x_max += MARGIN_VAL_X;\n    this.y_min = Math.min(1500, Math.max(0, this.y_min - MARGIN_VAL_Y_LOW));\n    this.y_max += MARGIN_VAL_Y_HIGH;\n\n    this.labelTextStyle = new PIXI.TextStyle({\n      fontFamily: LABEL_FONT_FAMILY,\n      fontSize: 12 * this.R,\n      fill: 0x000000,\n    });\n\n    void this.initBackground();\n    void this.initChart(ratingHistory, statusCanvas);\n  }\n\n  initBackground(): void {\n    if (this.chartContainer === undefined) return;\n\n    const panelGraphics = new Graphics();\n    panelGraphics.x = OFFSET_X * this.R;\n    panelGraphics.y = OFFSET_Y * this.R;\n    panelGraphics.alpha = 0.3;\n    const borderGraphics = new Graphics();\n    borderGraphics.x = OFFSET_X * this.R;\n    borderGraphics.y = OFFSET_Y * this.R;\n\n    void this.chartContainer.addChild(panelGraphics);\n    void this.chartContainer.addChild(borderGraphics);\n\n    // 背景色を塗る\n    let y1 = 0;\n    for (let i = COLORS.length - 1; i >= 0; i--) {\n      const y2 =\n        PANEL_HEIGHT -\n        PANEL_HEIGHT * getPer(COLORS[i][0], this.y_min, this.y_max);\n      if (y2 > 0 && y1 < PANEL_HEIGHT) {\n        y1 = Math.max(y1, 0);\n        panelGraphics\n          .beginFill(COLORS[i][3])\n          .drawRect(\n            0,\n            y1 * this.R,\n            PANEL_WIDTH * this.R,\n            (Math.min(y2, PANEL_HEIGHT) - y1) * this.R\n          )\n          .endFill();\n      }\n      y1 = y2;\n    }\n\n    const newLabelY = (s: string, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = (OFFSET_X - 10) * this.R;\n      t.y = (OFFSET_Y + y) * this.R;\n      t.anchor.x = 1.0;\n      t.anchor.y = 0.5;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    const newLabelX = (s: string, x: number, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = (OFFSET_X + x) * this.R;\n      t.y = (OFFSET_Y + PANEL_HEIGHT + 2 + y) * this.R;\n      t.anchor.x = 0.5;\n      t.anchor.y = 0.0;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    // y 軸ラベルとグリッド線を追加する\n    for (let i = 0; i <= this.y_max; i += STEP_SIZE) {\n      if (i >= this.y_min) {\n        const y =\n          PANEL_HEIGHT - PANEL_HEIGHT * getPer(i, this.y_min, this.y_max);\n        void newLabelY(String(i), y);\n        borderGraphics.lineStyle(1.0 * this.R, 0xffffff);\n        if (i === 2000) borderGraphics.lineStyle(1.0 * this.R, 0x000000);\n        borderGraphics\n          .moveTo(0, y * this.R)\n          .lineTo(PANEL_WIDTH * this.R, y * this.R);\n      }\n    }\n    borderGraphics.lineStyle(1.0 * this.R, 0xffffff);\n\n    // x 軸ラベルとグリッド線を追加する\n    let month_step = 6;\n    for (let i = 3; i >= 1; i--) {\n      if (this.x_max - this.x_min <= YEAR_SEC * i + MARGIN_VAL_X * 2)\n        month_step = i;\n    }\n    let isFirst = true;\n    for (let i = START_YEAR; i < 3000; i++) {\n      let isEnded = false;\n      for (let j = 0; j < 12; j += month_step) {\n        const month = `0${j + 1}`.slice(-2);\n        const unix = Date.parse(`${i}-${month}-01T00:00:00`) / 1000;\n        if (this.x_min < unix && unix < this.x_max) {\n          const x = PANEL_WIDTH * getPer(unix, this.x_min, this.x_max);\n          if (j === 0 || isFirst) {\n            void newLabelX(MONTH_NAMES[j], x, 0);\n            void newLabelX(String(i), x, 13);\n            isFirst = false;\n          } else {\n            void newLabelX(MONTH_NAMES[j], x, 0);\n          }\n          borderGraphics\n            .moveTo(x * this.R, 0)\n            .lineTo(x * this.R, PANEL_HEIGHT * this.R);\n        }\n        if (unix > this.x_max) {\n          isEnded = true;\n          break;\n        }\n      }\n      if (isEnded) break;\n    }\n    borderGraphics\n      .lineStyle(1.5 * this.R, 0x888888)\n      .drawRoundedRect(\n        0,\n        0,\n        PANEL_WIDTH * this.R,\n        PANEL_HEIGHT * this.R,\n        2 * this.R\n      );\n  }\n\n  initChart(\n    ratingHistory: RatingHistoryEntryEx[],\n    statusGraphics: StatusCanvas\n  ): void {\n    if (this.chartContainer === undefined) return;\n\n    const chartGraphics = new Graphics();\n    this.chartContainer.addChild(chartGraphics);\n    // chart_container.shadow = new cj.Shadow(\"rgba(0,0,0,0.3)\", 1, 2, 3);\n    const dropShadowFilter = new DropShadowFilter();\n    dropShadowFilter.color = 0x000000;\n    dropShadowFilter.alpha = 0.3;\n    dropShadowFilter.distance = Math.hypot(1, 2) * this.R;\n    dropShadowFilter.angle = Math.atan2(1, 2);\n    dropShadowFilter.blur = 3 * this.R;\n    chartGraphics.filters = [dropShadowFilter];\n\n    const lineGraphics = newGraphics(chartGraphics);\n    const highestGraphics = newGraphics(chartGraphics);\n    highestGraphics.interactive = true;\n\n    const mouseoverVertex = (i: number): void => {\n      vertexGraphics[i].scale.x = vertexGraphics[i].scale.y = 1.2;\n      statusGraphics.set(ratingHistory[i], true);\n    };\n\n    const mouseoutVertex = (i: number): void => {\n      vertexGraphics[i].scale.x = vertexGraphics[i].scale.y = 1;\n    };\n    const { argmax: highestIdx } = ratingHistory.reduce(\n      ({ argmax, maxRating }, ratingHistoryEntry, index) => {\n        const rating = this.getRating(ratingHistoryEntry);\n        if (rating > maxRating) {\n          argmax = index;\n          maxRating = rating;\n        }\n        return { argmax, maxRating };\n      },\n      { argmax: 0, maxRating: 0 }\n    );\n\n    const vertexGraphics = ratingHistory.map((ratingHistoryEntry, index) => {\n      const vertex = newGraphics(chartGraphics);\n      vertex.lineStyle(1.0 * this.R, 0xffffff);\n      if (index === highestIdx) vertex.lineStyle(1.0 * this.R, 0x000000);\n      const rating = this.getRating(ratingHistoryEntry);\n      vertex.beginFill(getColor(rating)[3]).drawCircle(0, 0, 3.5 * this.R);\n      vertex.x =\n        (OFFSET_X +\n          PANEL_WIDTH *\n            getPer(ratingHistoryEntry.EndTime, this.x_min, this.x_max)) *\n        this.R;\n      vertex.y =\n        (OFFSET_Y +\n          (PANEL_HEIGHT -\n            PANEL_HEIGHT * getPer(rating, this.y_min, this.y_max))) *\n        this.R;\n      vertex.interactive = true;\n      vertex.on('mouseover', () => {\n        mouseoverVertex(index);\n      });\n      vertex.on('mouseout', () => {\n        mouseoutVertex(index);\n      });\n      return vertex;\n    });\n    {\n      let dx = 80 * this.R;\n      if ((this.x_min + this.x_max) / 2 < ratingHistory[highestIdx].EndTime)\n        dx = -80 * this.R;\n      const x = vertexGraphics[highestIdx].x + dx;\n      const y = vertexGraphics[highestIdx].y - 16;\n      highestGraphics\n        .lineStyle(1.0 * this.R, 0xffffff)\n        .moveTo(vertexGraphics[highestIdx].x, vertexGraphics[highestIdx].y)\n        .lineTo(x, y);\n      highestGraphics\n        .lineStyle(1.0 * this.R, 0x888888)\n        .beginFill(0xffffff)\n        .drawRoundedRect(\n          x - (HIGHEST_WIDTH / 2) * this.R,\n          y - (HIGHEST_HEIGHT / 2) * this.R,\n          HIGHEST_WIDTH * this.R,\n          HIGHEST_HEIGHT * this.R,\n          2 * this.R\n        );\n      const highest_text = new PIXI.Text(\n        `Highest: ${this.getRating(ratingHistory[highestIdx])}`,\n        this.labelTextStyle\n      );\n      highest_text.x = x;\n      highest_text.y = y;\n      highest_text.anchor.x = 0.5;\n      highest_text.anchor.y = 0.5;\n      this.chartContainer.addChild(highest_text);\n\n      highestGraphics.on('mouseover', () => {\n        mouseoverVertex(highestIdx);\n      });\n      highestGraphics.on('mouseout', () => {\n        mouseoutVertex(highestIdx);\n      });\n    }\n    // 折れ線を描画\n    (\n      [\n        [2.0, 0xaaaaaa],\n        [1.0, 0xffffff],\n      ] as [number, number][]\n    ).forEach(([width, color]) => {\n      lineGraphics.lineStyle(width * this.R, color);\n      lineGraphics.moveTo(vertexGraphics[0].x, vertexGraphics[0].y);\n      vertexGraphics.forEach((vertex) => {\n        lineGraphics.lineTo(vertex.x, vertex.y);\n      });\n    });\n  }\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport useFontFaceObserver from 'use-font-face-observer';\nimport * as PIXI from 'pixi.js';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { ChartCanvas, ChartCanvasMode } from './ChartCanvas';\nimport {\n  StatusCanvas,\n  LABEL_FONT_FAMILY,\n  RATING_FONT_FAMILY,\n} from './StatusCanvas';\n\ninterface Props {\n  ratingHistory?: RatingHistoryEntryEx[];\n  paramUser: string;\n  mode: ChartCanvasMode;\n}\n\nexport const RatingGraph: React.FC<Props> = (props) => {\n  const { ratingHistory, mode } = props;\n  const isFontListLoaded = useFontFaceObserver([\n    { family: RATING_FONT_FAMILY },\n    { family: LABEL_FONT_FAMILY },\n  ]);\n  const statusCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const chartCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const [canvases, setCanvases] = useState<[StatusCanvas, ChartCanvas]>();\n\n  const R = 1.0;\n  useEffect(() => {\n    const statusCanvas: HTMLCanvasElement | null = statusCanvasRef.current;\n    const chartCanvas: HTMLCanvasElement | null = chartCanvasRef.current;\n    if (statusCanvas === null || chartCanvas === null) return;\n\n    const _statusApp = new PIXI.Application({\n      width: 640,\n      height: 80,\n      view: statusCanvas,\n      antialias: true,\n    });\n    const _chartApp = new PIXI.Application({\n      width: 640 * R,\n      height: 360 * R,\n      view: chartCanvas,\n      antialias: true,\n    });\n\n    _statusApp.renderer.backgroundColor = 0xffffff;\n    _chartApp.renderer.backgroundColor = 0xffffff;\n\n    const _statusCanvas = new StatusCanvas(_statusApp, mode);\n    const _chartCanvas = new ChartCanvas(_chartApp, mode);\n\n    // _statusCanvas.init();\n    setCanvases([_statusCanvas, _chartCanvas]);\n  }, []);\n\n  useEffect(() => {\n    if (!isFontListLoaded) return;\n    if (!ratingHistory) return;\n    if (!canvases) return;\n\n    const [statusCanvas, chartCanvas] = canvases;\n    if (ratingHistory.length === 0) {\n      chartCanvas.destroy();\n      statusCanvas.destroy();\n      return;\n    }\n    const lastHistory = ratingHistory[ratingHistory.length - 1];\n\n    statusCanvas.init();\n    chartCanvas.init(ratingHistory, statusCanvas);\n    statusCanvas.set(lastHistory, false);\n  }, [isFontListLoaded, ratingHistory, canvases]);\n\n  return (\n    <>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '80px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={statusCanvasRef}\n          width=\"640\"\n          height=\"80\"\n        ></canvas>\n      </div>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '360px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={chartCanvasRef}\n          width=\"640\"\n          height=\"360\"\n        ></canvas>\n      </div>\n    </>\n  );\n};\n","import React, { useState } from 'react';\nimport useSWR from 'swr';\nimport { Alert, Nav, NavItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUser, faList } from '@fortawesome/free-solid-svg-icons';\nimport { FormBlock } from './FormBlock';\nimport { UserInfoTable } from './UserInfoTable';\nimport { Contest } from '../../interfaces/Contest';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport {\n  ContestResults,\n  fetchContestResults,\n  fetchContests,\n} from '../../utils/Data';\nimport { RatingRanks } from '../../utils/Rating';\nimport { ChartSection } from './ChartSection';\nimport './nav.scss';\nimport { HistoryTable } from './HistoryTable';\n\nenum ContentTab {\n  'chart' = 0,\n  'table' = 1,\n}\n\nconst ContentWrapper: React.FC<{\n  display: boolean;\n}> = (props) => <>{props.display ? props.children : <></>}</>;\n\nconst getNavClassName = (active: boolean): string => {\n  if (active) return 'active nav-link';\n  return 'nav-link';\n};\n\ninterface Props {\n  match: {\n    params: {\n      user: string;\n    };\n  };\n}\n\nexport const RatingPage: React.FC<Props> = (props) => {\n  const paramUser: string = props.match.params.user ?? '';\n  const [activeTab, setActiveTab] = useState<ContentTab>(ContentTab.chart);\n\n  const { data: contests, error: contestsError } = useSWR<Contest[], Error>(\n    '/json/contests/contests',\n    fetchContests\n  );\n  const { data: contestResultsArray, error: contestResultsArrayError } = useSWR<\n    (ContestResults | undefined)[],\n    Error\n  >(contests ? `/json/results/` : null, () => {\n    if (!contests) return Promise.resolve([undefined]);\n    const promises = contests.map((contest) =>\n      fetchContestResults(contest.slug)\n    );\n    return Promise.all(promises);\n  });\n\n  const ratingHistory =\n    paramUser && contestResultsArray\n      ? (contestResultsArray\n          .map((contestResults) => {\n            if (contestResults && paramUser in contestResults)\n              return contestResults[paramUser];\n            else return undefined;\n          })\n          .filter(\n            (contestResult) => contestResult !== undefined\n          ) as RatingHistoryEntryEx[])\n      : undefined;\n  const ratingRanks = new RatingRanks(contestResultsArray);\n\n  return (\n    <>\n      <h2>Description</h2>\n      <p>\n        AtCoder\n        で行われたマラソンコンテストのレーティング推移をグラフに表示します．\n      </p>\n      <p>\n        AtCoder\n        が公式にマラソンレートのグラフ表示機能を実装するまでのつなぎです．\n      </p>\n      <hr />\n\n      {contestsError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest list.\n        </Alert>\n      ) : contests === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest data...\n        </div>\n      ) : contestResultsArrayError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest results.\n        </Alert>\n      ) : contestResultsArray === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest results...\n        </div>\n      ) : (\n        <></>\n      )}\n      <FormBlock paramUser={paramUser} />\n      <hr />\n      {ratingHistory?.length ? (\n        <>\n          <Nav tabs className=\"justify-content-center\">\n            <NavItem>\n              <a\n                className={getNavClassName(activeTab === ContentTab.chart)}\n                onClick={() => {\n                  setActiveTab(ContentTab.chart);\n                }}\n              >\n                <FontAwesomeIcon style={{ marginRight: '4px' }} icon={faUser} />\n                Profile\n              </a>\n            </NavItem>\n            <NavItem>\n              <a\n                className={getNavClassName(activeTab === ContentTab.table)}\n                onClick={() => {\n                  setActiveTab(ContentTab.table);\n                }}\n              >\n                <FontAwesomeIcon style={{ marginRight: '4px' }} icon={faList} />\n                Competition History\n              </a>\n            </NavItem>\n          </Nav>\n          <ContentWrapper display={activeTab === ContentTab.chart}>\n            <div\n              style={{\n                maxWidth: '640px',\n                marginLeft: 'auto',\n                marginRight: 'auto',\n              }}\n            >\n              <UserInfoTable\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n                ratingRanks={ratingRanks}\n              />\n              <ChartSection\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n                ratingRanks={ratingRanks}\n              />\n            </div>\n          </ContentWrapper>\n          <ContentWrapper display={activeTab === ContentTab.table}>\n            <div className=\"container\">\n              <HistoryTable\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n              />\n            </div>\n          </ContentWrapper>\n        </>\n      ) : (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          AtCoder ID is empty or invalid.\n        </Alert>\n      )}\n    </>\n  );\n};\n","export const RatingColors = [\n  'Black',\n  'Grey',\n  'Brown',\n  'Green',\n  'Cyan',\n  'Blue',\n  'Yellow',\n  'Orange',\n  'Red',\n] as const;\n\nexport type RatingColor = typeof RatingColors[number];\nexport const getRatingColor = (rating: number): RatingColor => {\n  const index = Math.min(Math.floor(rating / 400), RatingColors.length - 2);\n  return RatingColors[index + 1];\n};\nexport const getRatingColorCode = (ratingColor: RatingColor): string => {\n  switch (ratingColor) {\n    case 'Black':\n      return '#000000'; // black\n    case 'Grey':\n      return '#808080'; // grey\n    case 'Brown':\n      return '#804000'; // brown\n    case 'Green':\n      return '#008000'; // green\n    case 'Cyan':\n      return '#00C0C0'; // cyan\n    case 'Blue':\n      return '#0000FF'; // blue\n    case 'Yellow':\n      return '#C0C000'; // yellow\n    case 'Orange':\n      return '#FF8000'; // orange\n    case 'Red':\n      return '#FF0000'; // red\n  }\n};\n\nexport type RatingColorClassName =\n  | 'difficulty-black'\n  | 'difficulty-grey'\n  | 'difficulty-brown'\n  | 'difficulty-green'\n  | 'difficulty-cyan'\n  | 'difficulty-blue'\n  | 'difficulty-yellow'\n  | 'difficulty-orange'\n  | 'difficulty-red';\nexport const getRatingColorClass = (rating: number): RatingColorClassName => {\n  const ratingColor = getRatingColor(rating);\n  switch (ratingColor) {\n    case 'Black':\n      return 'difficulty-black';\n    case 'Grey':\n      return 'difficulty-grey';\n    case 'Brown':\n      return 'difficulty-brown';\n    case 'Green':\n      return 'difficulty-green';\n    case 'Cyan':\n      return 'difficulty-cyan';\n    case 'Blue':\n      return 'difficulty-blue';\n    case 'Yellow':\n      return 'difficulty-yellow';\n    case 'Orange':\n      return 'difficulty-orange';\n    case 'Red':\n      return 'difficulty-red';\n  }\n};\n\nexport const getRatingColorBG = (rating: number): string => {\n  const ratingColor = getRatingColor(rating);\n  switch (ratingColor) {\n    case 'Black':\n      return '#D9D9D9';\n    case 'Grey':\n      return '#D9D9D9';\n    case 'Brown':\n      return '#D9C5B2';\n    case 'Green':\n      return '#B2D9B2';\n    case 'Cyan':\n      return '#B2ECEC';\n    case 'Blue':\n      return '#B2B2FF';\n    case 'Yellow':\n      return '#ECECB2';\n    case 'Orange':\n      return '#FFD9B2';\n    case 'Red':\n      return '#FFB2B2';\n  }\n};\n","import React from 'react';\nimport BootstrapTable, {\n  ColumnDescription,\n  SortOrder,\n} from 'react-bootstrap-table-next';\nimport filterFactory from 'react-bootstrap-table2-filter';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faSearch,\n  faSortAmountDown,\n  faSortAmountDownAlt,\n  faSort,\n} from '@fortawesome/free-solid-svg-icons';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { formatDatetime, getDiff } from '../../utils';\nimport { getRatingColorBG } from '../../utils/RatingColor';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport './history-table.scss';\n\nconst _sortCaret = (order: 'asc' | 'desc' | undefined): JSX.Element => {\n  if (order === 'asc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n        }}\n        icon={faSortAmountDown}\n      />\n    );\n  if (order === 'desc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n        }}\n        icon={faSortAmountDownAlt}\n      />\n    );\n  return (\n    <FontAwesomeIcon\n      style={{ marginLeft: '6px', opacity: 0.2 }}\n      icon={faSort}\n    />\n  );\n};\n\ninterface Props {\n  paramUser: string;\n  ratingHistory: RatingHistoryEntryEx[];\n}\n\nexport const HistoryTable: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory } = props;\n\n  const columns: ColumnDescription[] = [\n    {\n      dataField: 'EndTime',\n      text: 'Date',\n      sort: true,\n      formatter: function _formatter(cell: number) {\n        const date = new Date(cell * 1000);\n        return (\n          <>\n            <span>{formatDatetime(date)}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'ContestName',\n      text: 'Contest',\n      sort: true,\n      classes: 'history-table-contest',\n      formatter: function _formatter(cell: string, _row: RatingHistoryEntryEx) {\n        const btnId = `js-history-user-btn-submission-${_row.slug}`;\n        return (\n          <>\n            <a\n              href={`https://atcoder.jp/contests/${_row.slug}`}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              {cell}\n            </a>\n            <span className=\"history-user-btn\">\n              <a\n                href={`https://atcoder.jp/contests/${_row.slug}/submissions?f.User=${paramUser}`}\n                id={btnId}\n              >\n                <FontAwesomeIcon icon={faSearch} />\n              </a>\n              <UncontrolledTooltip placement=\"top\" target={btnId}>\n                {`view ${paramUser}'s submissions`}\n              </UncontrolledTooltip>\n            </span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: string, b: string, order: SortOrder) {\n        if (order === 'desc') {\n          return a > b ? 1 : -1;\n        } else {\n          return b < a ? -1 : 1;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'Place',\n      text: 'Rank',\n      sort: true,\n      formatter: function _formatter(cell: number, _row: RatingHistoryEntryEx) {\n        return (\n          <>\n            <a href={_row.StandingsUrl} target=\"_blank\" rel=\"noreferrer\">\n              {cell}\n            </a>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'performance',\n      text: 'Performance',\n      sort: true,\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      style: function _style(cell: number) {\n        return { backgroundColor: getRatingColorBG(cell) };\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'NewRating',\n      text: 'New Rating',\n      sort: true,\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      style: function _style(cell: number) {\n        return { backgroundColor: getRatingColorBG(cell) };\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'change',\n      text: 'Diff',\n      sort: true,\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{getDiff(cell)}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n  ];\n  const data = [...ratingHistory].reverse();\n\n  return (\n    <BootstrapTable\n      bootstrap4\n      classes=\"th-center th-middle td-center td-middle table-standings\"\n      striped\n      keyField=\"EndTime\"\n      filter={filterFactory()}\n      wrapperClasses=\"table-responsive\"\n      data={data}\n      columns={columns}\n    />\n  );\n};\n","import React from 'react';\nimport { PaginationOptions } from 'react-bootstrap-table-next';\nimport {\n  Col,\n  Pagination,\n  PaginationItem,\n  PaginationLink,\n  Row,\n} from 'reactstrap';\nimport { range } from '../utils';\nimport './pagination-panel.scss';\n\nconst pageList = (\n  currPage: number,\n  pageStartIndex: number,\n  totalPages: number\n): number[] => {\n  if (totalPages === 0) {\n    return [];\n  }\n  if (totalPages <= 10) {\n    return range(1, totalPages);\n  }\n\n  const pageNumbers = [currPage];\n  let tmpExp = 1;\n  for (;;) {\n    tmpExp *= 2;\n    const tmpPageNumber = currPage - tmpExp + 1;\n    if (tmpPageNumber < pageStartIndex) {\n      break;\n    }\n    pageNumbers.unshift(tmpPageNumber);\n  }\n  if (pageNumbers[0] !== pageStartIndex) {\n    pageNumbers.unshift(pageStartIndex);\n  }\n\n  tmpExp = 1;\n  for (;;) {\n    tmpExp *= 2;\n    const tmpPageNumber = currPage + tmpExp - 1;\n    if (tmpPageNumber > totalPages) {\n      break;\n    }\n    pageNumbers.push(tmpPageNumber);\n  }\n  if (pageNumbers.slice(-1)[0] !== totalPages) {\n    pageNumbers.push(totalPages);\n  }\n\n  return pageNumbers;\n};\n\ninterface PaginationChildProps extends PaginationOptions {\n  tableId?: string;\n  bootstrap4?: boolean;\n}\n\ninterface PaginationPanelProps extends PaginationChildProps {\n  renderSizePerPage: boolean;\n}\n\nexport const PaginationPanel: React.FC<PaginationPanelProps> = (props) => {\n  const {\n    renderSizePerPage,\n    totalSize,\n    sizePerPage,\n    sizePerPageList,\n    onSizePerPageChange,\n    page,\n    pageStartIndex,\n    onPageChange,\n  } = props;\n  if (\n    page === undefined ||\n    pageStartIndex === undefined ||\n    onPageChange === undefined ||\n    totalSize === undefined ||\n    sizePerPage === undefined ||\n    sizePerPageList === undefined ||\n    onSizePerPageChange === undefined\n  )\n    return null;\n  const totalPages = Math.ceil(totalSize / sizePerPage);\n  const pageNumbers = pageList(page, pageStartIndex, totalPages);\n\n  return (\n    <div className=\"pagination-panel-parent\">\n      {renderSizePerPage && (\n        <>\n          <Row>\n            <Col className=\"size-per-page\">\n              <span className=\"small\">\n                {'per page: '}\n                {(sizePerPageList as number[]).map((p) => (\n                  <a\n                    key={p}\n                    className={`standings-per-page${\n                      p === sizePerPage ? ' active' : ''\n                    }`}\n                    onClick={() => onSizePerPageChange(p, 1)}\n                  >\n                    {p}\n                  </a>\n                ))}\n              </span>\n            </Col>\n          </Row>\n          <hr className=\"size-per-page-splitter\" />\n        </>\n      )}\n      <Row>\n        <Col>\n          <Pagination\n            className=\"pagination-sm\"\n            style={{ flexWrap: 'wrap', justifyContent: 'center' }}\n          >\n            {pageNumbers.map((pageNumber) => (\n              <PaginationItem key={pageNumber} active={pageNumber === page}>\n                <PaginationLink\n                  onClick={() => onPageChange(pageNumber, sizePerPage)}\n                >\n                  {pageNumber}\n                </PaginationLink>\n              </PaginationItem>\n            ))}\n          </Pagination>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n","import React from 'react';\nimport { getRatingColorCode, RatingColor } from '../utils/RatingColor';\nimport './TopcoderLikeCircle.css';\n\ntype RatingMetalColor = 'Bronze' | 'Silver' | 'Gold';\nconst getRatingMetalColorCode = (metalColor: RatingMetalColor) => {\n  switch (metalColor) {\n    case 'Bronze':\n      return { base: '#965C2C', highlight: '#FFDABD' };\n    case 'Silver':\n      return { base: '#808080', highlight: 'white' };\n    case 'Gold':\n      return { base: '#FFD700', highlight: 'white' };\n  }\n};\n\ntype RatingColorWithMetal = RatingColor | RatingMetalColor;\nconst getStyleOptions = (color: RatingColorWithMetal, fillRatio: number) => {\n  if (color === 'Bronze' || color === 'Silver' || color === 'Gold') {\n    const metalColor = getRatingMetalColorCode(color);\n    return {\n      borderColor: metalColor.base,\n      background: `linear-gradient(to right, \\\n        ${metalColor.base}, ${metalColor.highlight}, ${metalColor.base})`,\n    };\n  } else {\n    const colorCode = getRatingColorCode(color);\n    return {\n      borderColor: colorCode,\n      background: `linear-gradient(to top, \\\n        ${colorCode} 0%, \\\n        ${colorCode} ${fillRatio * 100}%, \\\n        rgba(0,0,0,0) ${fillRatio * 100}%, \\\n        rgba(0,0,0,0) 100%)`,\n    };\n  }\n};\n\ninterface Props extends React.HTMLAttributes<HTMLElement> {\n  color: RatingColorWithMetal;\n  rating: number;\n  big?: boolean;\n}\n\nexport const TopcoderLikeCircle: React.FC<Props> = (props) => {\n  const { color, rating } = props;\n  const fillRatio = rating >= 3200 ? 1.0 : (rating % 400) / 400;\n  const className = `topcoder-like-circle \\\n    ${props.big ? 'topcoder-like-circle-big' : ''}`;\n  const styleOptions = getStyleOptions(color, fillRatio);\n  return (\n    <span\n      className={`${className} ${props.className ?? ''}`}\n      id={props.id}\n      style={styleOptions}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport { Badge, Tooltip } from 'reactstrap';\nimport { getRatingColor } from '../utils/RatingColor';\nimport { TopcoderLikeCircle } from './TopcoderLikeCircle';\nimport './RatingCircle.css';\n\ntype Rating = number;\n\ninterface Props {\n  id?: string;\n  rating?: Rating;\n}\n\nfunction getColor(rating: Rating) {\n  if (rating < 3200) {\n    return getRatingColor(rating);\n  } else if (rating < 3600) {\n    return 'Bronze';\n  } else if (rating < 4000) {\n    return 'Silver';\n  } else {\n    return 'Gold';\n  }\n}\n\nexport const RatingCircle: React.FC<Props> = (props) => {\n  const { id, rating } = props;\n  const [tooltipOpen, setTooltipOpen] = useState(false);\n  const toggleTooltipState = (): void => setTooltipOpen(!tooltipOpen);\n  const circleId = `RatingCircle-${id ?? ''}`;\n  if (rating === undefined || rating < 0) {\n    return (\n      <span>\n        <Badge\n          className=\"rating-unavailable-circle\"\n          color=\"info\"\n          id={circleId}\n          pill\n        >\n          ?\n        </Badge>\n        <Tooltip\n          placement=\"top\"\n          target={circleId}\n          isOpen={tooltipOpen}\n          toggle={toggleTooltipState}\n        >\n          Rating is unavailable.\n        </Tooltip>\n      </span>\n    );\n  }\n  const color = getColor(rating);\n\n  return (\n    <>\n      <TopcoderLikeCircle\n        color={color}\n        rating={rating}\n        className=\"rating-circle\"\n        id={circleId}\n      />\n      <Tooltip\n        placement=\"top\"\n        target={circleId}\n        isOpen={tooltipOpen}\n        toggle={toggleTooltipState}\n      >\n        {`Rating: ${rating}`}\n      </Tooltip>\n    </>\n  );\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport BootstrapTable, {\n  ColumnDescription,\n  SortOrder,\n} from 'react-bootstrap-table-next';\nimport paginationFactory, {\n  PaginationProvider,\n} from 'react-bootstrap-table2-paginator';\nimport filterFactory, { textFilter } from 'react-bootstrap-table2-filter';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faSort,\n  faSortDown,\n  faSortUp,\n  faChartLine,\n} from '@fortawesome/free-solid-svg-icons';\nimport { PaginationPanel } from '../../components/PaginationPanel';\nimport { getColor, RankingEntry } from '../../utils/Rating';\nimport { RatingCircle } from '../../components/RatingCircle';\nimport './ranking-table.scss';\nimport { UncontrolledTooltip } from 'reactstrap';\n\nconst _sortCaret = (order: 'asc' | 'desc' | undefined): JSX.Element => {\n  if (order === 'asc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n          marginTop: '0.2rem',\n          marginBottom: '-0.2rem',\n        }}\n        icon={faSortUp}\n      />\n    );\n  if (order === 'desc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n          marginTop: '-0.2rem',\n          marginBottom: '0.2rem',\n        }}\n        icon={faSortDown}\n      />\n    );\n  return <FontAwesomeIcon style={{ marginLeft: '6px' }} icon={faSort} />;\n};\n\ninterface Props {\n  ranking: RankingEntry[];\n}\n\nexport const RankingTable: React.FC<Props> = (props) => {\n  const { ranking } = props;\n\n  if (ranking.length === 0) {\n    return (\n      <div\n        style={{\n          width: '100%',\n          height: '500px',\n          textAlign: 'center',\n          marginTop: '100px',\n          marginBottom: '100px',\n        }}\n      >\n        Fetch data...\n      </div>\n    );\n  }\n\n  const columns: ColumnDescription[] = [\n    {\n      dataField: 'rank',\n      text: 'Rank',\n      sort: true,\n      classes: 'standings-rank',\n      headerClasses: 'standings-rank-head',\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'username',\n      text: 'User',\n      sort: true,\n      classes: 'standings-username',\n      headerClasses: 'standings-username-head',\n      filter: textFilter(),\n      formatter: function _formatter(cell: string, _row: RankingEntry) {\n        const btnId = `ranking-user-btn-submission-${cell}`;\n        return (\n          <>\n            <a\n              href={`https://atcoder.jp/users/${cell}`}\n              className=\"username\"\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n              style={{ color: getColor(_row.rating)[1] }}\n            >\n              <RatingCircle id={cell} rating={_row.rating} />{' '}\n              <span className=\"user\">{cell}</span>\n            </a>\n            <span className=\"ranking-user-btn\">\n              <Link to={`/rating/${cell}`} id={btnId}>\n                <FontAwesomeIcon icon={faChartLine} />\n              </Link>\n              <UncontrolledTooltip placement=\"top\" target={btnId}>\n                {`view ${cell}'s rating history`}\n              </UncontrolledTooltip>\n            </span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: string, b: string, order: SortOrder) {\n        if (order === 'desc') {\n          return a > b ? 1 : -1;\n        } else {\n          return b < a ? -1 : 1;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'rating',\n      text: 'Rating',\n      sort: true,\n      classes: 'standings-rating',\n      headerClasses: 'standings-rating-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span style={{ color: getColor(cell)[1] }}>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'match',\n      text: 'Match',\n      sort: true,\n      classes: 'standings-match',\n      headerClasses: 'standings-match-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'win',\n      text: 'Win',\n      sort: true,\n      classes: 'standings-win',\n      headerClasses: 'standings-win-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n  ];\n\n  return (\n    <>\n      <PaginationProvider\n        pagination={paginationFactory({\n          custom: true,\n          sizePerPage: 100,\n          sizePerPageList: [10, 20, 50, 100, 1000],\n          totalSize: ranking.length,\n        })}\n      >\n        {({ paginationProps, paginationTableProps }) => {\n          paginationTableProps.keyField = 'user_name';\n          paginationTableProps.data = ranking;\n          paginationTableProps.columns = columns;\n          return (\n            <div>\n              <PaginationPanel renderSizePerPage={true} {...paginationProps} />\n              <BootstrapTable\n                bootstrap4\n                classes=\"th-center th-middle td-center td-middle table-standings\"\n                striped\n                // keyField=\"user_name\"\n                // data={userStandingsEntries}\n                // columns={columns}\n                filter={filterFactory()}\n                wrapperClasses=\"table-responsive\"\n                {...paginationTableProps}\n              />\n              <PaginationPanel renderSizePerPage={false} {...paginationProps} />\n            </div>\n          );\n        }}\n      </PaginationProvider>\n      <hr />\n    </>\n  );\n};\n","import React from 'react';\nimport useSWR from 'swr';\nimport { Alert } from 'reactstrap';\nimport { Contest } from '../../interfaces/Contest';\nimport {\n  ContestResults,\n  fetchContestResults,\n  fetchContests,\n} from '../../utils/Data';\nimport { RankingEntry, RatingRanks } from '../../utils/Rating';\nimport { RankingTable } from './RankingTable';\n\nexport const RankingPage: React.FC = () => {\n  const { data: contests, error: contestsError } = useSWR<Contest[], Error>(\n    '/json/contests/contests',\n    fetchContests\n  );\n  const { data: contestResultsArray, error: contestResultsArrayError } = useSWR<\n    (ContestResults | undefined)[],\n    Error\n  >(contests ? `/json/results/` : null, () => {\n    if (!contests) return Promise.resolve([undefined]);\n    const promises = contests.map((contest) =>\n      fetchContestResults(contest.slug)\n    );\n    return Promise.all(promises);\n  });\n\n  const ratingRanks = new RatingRanks(contestResultsArray);\n  // {rank, rating, username}[]\n  const ranking: RankingEntry[] = ratingRanks.getRanking();\n\n  return (\n    <>\n      <h2>Description</h2>\n      <p>AtCoder で行われたマラソンコンテストの総合ランキングを表示します．</p>\n      <p>\n        AtCoder\n        が公式にマラソンレートの総合ランキング表示機能を実装するまでのつなぎです．\n      </p>\n      <hr />\n\n      {contestsError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest list.\n        </Alert>\n      ) : contests === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest data...\n        </div>\n      ) : contestResultsArrayError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest results.\n        </Alert>\n      ) : contestResultsArray === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest results...\n        </div>\n      ) : (\n        <></>\n      )}\n      <RankingTable ranking={ranking} />\n    </>\n  );\n};\n","import React from 'react';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\nimport { Container } from 'reactstrap';\nimport { SWRConfig } from 'swr';\nimport { NavigationBar } from './components/NavigationBar';\n// import logo from './logo.svg';\nimport './App.css';\nimport { RatingPage } from './pages/rating';\nimport { RankingPage } from './pages/ranking';\n\nconst App: React.FC = () => {\n  return (\n    <div className=\"App\">\n      <SWRConfig value={{ revalidateOnFocus: false }}>\n        <Router>\n          <NavigationBar />\n          <Container\n            style={{ width: '100%', maxWidth: '90%', marginTop: '80px' }}\n          >\n            <Switch>\n              <Route\n                exact\n                path=\"/rating/:user\"\n                component={RatingPage as React.FC}\n              />\n              <Route exact path=\"/rating/\" component={RatingPage as React.FC} />\n              <Route exact path=\"/ranking/\" component={RankingPage} />\n              <Redirect path=\"/\" to=\"/rating/\" />\n            </Switch>\n          </Container>\n          <footer\n            className=\"footer\"\n            style={{\n              marginTop: '30px',\n              padding: '30px',\n              backgroundColor: '#efefef',\n            }}\n          >\n            <div className=\"container\">\n              連絡先:{' '}\n              <a\n                href=\"https://twitter.com/iiljj\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                si (@iiljj) / Twitter\n              </a>\n              {', '}\n              <a\n                href=\"https://github.com/iilj\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                iilj (iilj) / GitHub\n              </a>\n            </div>\n          </footer>\n        </Router>\n      </SWRConfig>\n    </div>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    void import('web-vitals').then(\n      ({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n        getCLS(onPerfEntry);\n        getFID(onPerfEntry);\n        getFCP(onPerfEntry);\n        getLCP(onPerfEntry);\n        getTTFB(onPerfEntry);\n      }\n    );\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
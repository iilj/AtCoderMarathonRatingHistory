{"version":3,"sources":["pages/rating/ChartSection.tsx","components/NavigationBar.tsx","pages/rating/FormBlock.tsx","utils/index.ts","utils/BinaryIndexedTree.ts","utils/Rating.ts","pages/rating/UserInfoTable.tsx","utils/Data.ts","utils/Shape.ts","pages/rating/StatusCanvas.ts","pages/rating/RatingDistributionChartCanvas.ts","pages/rating/RatingDistributionGraph.tsx","pages/rating/ChartCanvas.ts","pages/rating/RatingGraph.tsx","pages/rating/index.tsx","utils/RatingColor.ts","pages/rating/HistoryTable.tsx","components/PaginationPanel.tsx","components/TopcoderLikeCircle.tsx","components/RatingCircle.tsx","pages/ranking/RankingTable.tsx","pages/ranking/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ChartTab","NavigationBar","useState","isOpen","setIsOpen","Navbar","color","light","expand","fixed","NavbarBrand","tag","Link","to","NavbarToggler","onClick","Collapse","navbar","Nav","className","NavItem","NavLink","style","marginRight","icon","faChartLine","faSortAmountDown","FormBlock","props","paramUser","user","setUser","ratingPagePath","useMemo","generatePath","history","useHistory","Row","Col","sm","FormGroup","width","Label","for","Input","value","type","name","id","placeholder","onChange","e","target","onKeyPress","key","push","Button","block","display","marginTop","pad","n","slice","getOrdinal","x","s","v","formatDate","d","year","String","getFullYear","month","getMonth","date","getDate","DAYS","formatDatetime","day","getDay","hours","getHours","minutes","getMinutes","getPer","l","r","getDiff","Math","abs","BinaryIndexedTree","_length","data","length","this","Array","fill","k","ret","sum","COLORS","getColor","i","RatingRanks","contestResultsArray","bit","user2rating","user2ratingRankHistory","ratings","Map","undefined","forEach","contestResults","username","rankingEntry","get","oldRating","rating","NewRating","match","Place","win","add","set","rank","query","has","from","values","map","sort","a","b","ratingAndRank","xaxis","index","findIndex","pop","ratingAndUsername","UserInfoTable","ratingHistory","ratingRanks","lastResult","lastCompeted","Date","EndTime","getRank","ratingColor","fontSize","CONTESTS","fetchContests","fetch","process","catch","Error","then","json","Promise","resolve","CONTEST_RESULTS_MAP","fetchContestResults","contest","submissions","newGraphics","parent","Graphics","addChild","newText","y","font","t","PIXI","fontFamily","anchor","LABEL_FONT_FAMILY","RATING_FONT_FAMILY","OFFSET_X","STATUS_WIDTH","STATUS_HEIGHT","Particle","statusContainer","object","angle","speed","velocityX","velocityY","rotateSpeed","life","initialX","initialY","alpha","useStar","random","PI","cos","sin","visible","text","scale","rotation","Particles","particles","num","particle","disable","update","StatusCanvas","app","mode","borderGraphics","ratingText","placeText","diffText","dateText","contestNameText","standingsUrl","ticker","maxFPS","animate","destroy","children","texture","baseTexture","stage","OFFSET_Y","interactive","cursor","on","window","location","href","particle_flag","performance","old_rating","OldRating","place","contest_name","ContestName","tmp","clear","lineStyle","drawRoundedRect","toLocaleDateString","particleNum","floor","pow","pre","getRatingPer","StandingsUrl","PANEL_WIDTH","PANEL_HEIGHT","RatingDistributionChartCanvas","chartContainer","chartGraphics","labelTextStyle","yMax","lineGraphics","reduce","prev","curr","max","initBackground","initChart","panelGraphics","newLabelY","newLabelX","moveTo","lineTo","dropShadowFilter","DropShadowFilter","distance","hypot","atan2","blur","filters","countText","countGraphics","histogramGraphics","rectHeight","x0","x1","beginFill","drawRect","hitAreaRect","hitArea","mouseover","initUserRatingLine","col","per","getXandColor","RatingDistributionGraph","isFontListLoaded","useFontFaceObserver","family","chartCanvasRef","useRef","canvas","setCanvas","useEffect","chartCanvas","current","_chartApp","height","view","antialias","renderer","backgroundColor","_chartCanvas","init","margin","maxWidth","maxHeight","ref","MARGIN_VAL_X","MONTH_NAMES","ChartCanvas","x_min","x_max","y_min","y_max","R","ratingHistoryEntry","statusCanvas","min","getRating","y1","y2","endFill","month_step","isFirst","isEnded","j","unix","parse","statusGraphics","highestGraphics","mouseoverVertex","vertexGraphics","mouseoutVertex","highestIdx","argmax","maxRating","vertex","drawCircle","dx","HIGHEST_WIDTH","HIGHEST_HEIGHT","highest_text","RatingGraph","statusCanvasRef","canvases","setCanvases","_statusApp","_statusCanvas","lastHistory","ContentTab","ChartWrapper","ChartSection","activeTab","setActiveTab","tweetTitle","setTweetTitle","_tweetTitle","face","getDiffText","slug","hashtags","startsWith","toUpperCase","getHashtagSet","join","getHistogram","ButtonGroup","size","active","ratingDistribution","textAlign","TwitterShareButton","url","title","TwitterIcon","round","UncontrolledTooltip","placement","replaceAll","RatingColors","getRatingColor","getRatingColorBG","_sortCaret","order","marginLeft","faSortAmountDownAlt","opacity","faSort","HistoryTable","columns","dataField","formatter","cell","sortFunc","sortCaret","classes","_row","btnId","rel","faSearch","reverse","bootstrap4","striped","keyField","filter","filterFactory","wrapperClasses","ContentWrapper","getNavClassName","RatingPage","params","chart","useSWR","contests","contestsError","error","promises","all","contestResultsArrayError","contestResult","Alert","marginBottom","tabs","faUser","table","faList","pageList","currPage","pageStartIndex","totalPages","start","end","pageNumbers","tmpExp","tmpPageNumber","unshift","PaginationPanel","renderSizePerPage","totalSize","sizePerPage","sizePerPageList","onSizePerPageChange","page","onPageChange","ceil","p","Pagination","flexWrap","justifyContent","pageNumber","PaginationItem","PaginationLink","TopcoderLikeCircle","fillRatio","big","styleOptions","metalColor","base","highlight","getRatingMetalColorCode","borderColor","background","colorCode","getRatingColorCode","getStyleOptions","RatingCircle","tooltipOpen","setTooltipOpen","toggleTooltipState","circleId","Badge","pill","Tooltip","toggle","faSortUp","faSortDown","RankingTable","ranking","headerClasses","textFilter","_a","_b","pagination","paginationFactory","custom","paginationProps","paginationTableProps","RankingPage","getRanking","App","revalidateOnFocus","Container","exact","path","component","padding","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.89c73243.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport { Button, ButtonGroup, UncontrolledTooltip } from 'reactstrap';\nimport { TwitterIcon, TwitterShareButton } from 'react-share';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { RatingRanks } from '../../utils/Rating';\nimport { RatingDistributionGraph } from './RatingDistributionGraph';\nimport { RatingGraph } from './RatingGraph';\nimport { getDiff, getHashtagSet, getOrdinal } from '../../utils';\n\ninterface Props {\n  paramUser: string;\n  ratingHistory?: RatingHistoryEntryEx[];\n  ratingRanks: RatingRanks;\n}\n\nenum ChartTab {\n  'rating' = 0,\n  'performance' = 1,\n  'ratingDistribution' = 2,\n}\n\nconst ChartWrapper: React.FC<{\n  display: boolean;\n}> = (props) => <>{props.display ? props.children : <></>}</>;\n\nconst getDiffText = (x: number): string => {\n  const face = x === 0 ? ':|' : x < 0 ? ':(' : ':)';\n  return `(${getDiff(x)}) ${face}`;\n};\n\nexport const ChartSection: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory, ratingRanks } = props;\n\n  const [activeTab, setActiveTab] = useState<ChartTab>(ChartTab.rating);\n  const [tweetTitle, setTweetTitle] = useState('');\n\n  useEffect(() => {\n    if (!ratingHistory) return;\n    const lastHistory = ratingHistory[ratingHistory.length - 1];\n    const rank = lastHistory.Place;\n    const _tweetTitle =\n      `${paramUser} took ${getOrdinal(rank)} place in ${\n        lastHistory.ContestName\n      }!\\n` +\n      `Performance: ${lastHistory.performance}\\n` +\n      `Rating: ${lastHistory.OldRating}→${lastHistory.NewRating} ${getDiffText(\n        lastHistory.NewRating - lastHistory.OldRating\n      )}\\n` +\n      (lastHistory.NewRating > lastHistory.OldRating\n        ? 'Updated highest rating!\\n'\n        : '') +\n      `${getHashtagSet(lastHistory.slug).join(' ')}\\n\\n` +\n      `AtCoder Marathon Rating History\\n`;\n    setTweetTitle(_tweetTitle);\n  }, [paramUser, ratingHistory]);\n\n  const [xaxis, data] = ratingRanks.getHistogram();\n  const rating = ratingRanks.getRating(paramUser);\n\n  return (\n    <>\n      <div style={{ marginTop: '20px' }}>\n        <ButtonGroup size=\"sm\" className=\"btn-group-ac-style\">\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.rating);\n            }}\n            active={activeTab === ChartTab.rating}\n          >\n            Rating\n          </Button>\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.performance);\n            }}\n            active={activeTab === ChartTab.performance}\n          >\n            Performance\n          </Button>\n          <Button\n            onClick={() => {\n              setActiveTab(ChartTab.ratingDistribution);\n            }}\n            active={activeTab === ChartTab.ratingDistribution}\n          >\n            Rating Distribution\n          </Button>\n        </ButtonGroup>\n      </div>\n\n      <div style={{ marginTop: '20px' }}>\n        <ChartWrapper display={activeTab === ChartTab.rating}>\n          <RatingGraph\n            paramUser={paramUser}\n            ratingHistory={ratingHistory}\n            mode=\"Rating\"\n          />\n        </ChartWrapper>\n        <ChartWrapper display={activeTab === ChartTab.performance}>\n          <RatingGraph\n            paramUser={paramUser}\n            ratingHistory={ratingHistory}\n            mode=\"Performance\"\n          />\n        </ChartWrapper>\n        <ChartWrapper display={activeTab === ChartTab.ratingDistribution}>\n          <RatingDistributionGraph xaxis={xaxis} data={data} rating={rating} />\n        </ChartWrapper>\n      </div>\n      <div style={{ textAlign: 'center', marginTop: '30px' }}>\n        <TwitterShareButton\n          url={window.location.href}\n          title={tweetTitle}\n          id=\"chart-share-button\"\n        >\n          <TwitterIcon size={40} round />\n        </TwitterShareButton>\n        <UncontrolledTooltip placement=\"top\" target=\"chart-share-button\">\n          {(tweetTitle + ' ' + window.location.href).replaceAll('\\n', ' ')}\n        </UncontrolledTooltip>\n      </div>\n    </>\n  );\n};\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport {\n  Collapse,\n  Nav,\n  Navbar,\n  NavLink,\n  NavbarBrand,\n  NavbarToggler,\n  NavItem,\n} from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faChartLine,\n  faSortAmountDown,\n} from '@fortawesome/free-solid-svg-icons';\n\nexport const NavigationBar: React.FC = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const toggle = () => setIsOpen(!isOpen);\n\n  return (\n    <Navbar color=\"light\" light expand=\"md\" fixed=\"top\">\n      <NavbarBrand tag={Link} to={'/'}>\n        AtCoder Marathon Rating History\n      </NavbarBrand>\n      <NavbarToggler onClick={toggle} />\n      <Collapse isOpen={isOpen} navbar>\n        <Nav className=\"mr-auto\" navbar>\n          <NavItem>\n            <NavLink tag={Link} to=\"/rating/\">\n              <FontAwesomeIcon\n                style={{ marginRight: '4px' }}\n                icon={faChartLine}\n              />\n              Rating\n            </NavLink>\n          </NavItem>\n          <NavItem>\n            <NavLink tag={Link} to=\"/ranking/\">\n              <FontAwesomeIcon\n                style={{ marginRight: '4px' }}\n                icon={faSortAmountDown}\n              />\n              Ranking\n            </NavLink>\n          </NavItem>\n        </Nav>\n      </Collapse>\n    </Navbar>\n  );\n};\n","import React, { useState, useMemo } from 'react';\nimport { NavLink, useHistory } from 'react-router-dom';\nimport { Button, Input, Row, FormGroup, Label, Col } from 'reactstrap';\n\ninterface Props {\n  paramUser: string;\n}\n\nconst generatePath = (user: string): string => `/rating/${user}`;\n\nexport const FormBlock: React.FC<Props> = (props) => {\n  const { paramUser } = props;\n  const [user, setUser] = useState(paramUser);\n  const ratingPagePath = useMemo(() => generatePath(user), [user]);\n  const history = useHistory();\n\n  return (\n    <>\n      <Row>\n        <Col sm={12}>\n          <FormGroup style={{ width: '100%' }}>\n            <Label for=\"input-user\">ATCODER ID:</Label>\n            <Input\n              value={user}\n              type=\"text\"\n              name=\"input-user\"\n              id=\"input-user\"\n              placeholder={user ? user : 'eivour'}\n              onChange={(e): void => setUser(e.target.value)}\n              onKeyPress={(e): void => {\n                if (e.key === 'Enter') {\n                  history.push(ratingPagePath);\n                }\n              }}\n            />\n          </FormGroup>\n        </Col>\n      </Row>\n      <Row>\n        <Col sm={12}>\n          <Button\n            color=\"primary\"\n            tag={NavLink}\n            to={ratingPagePath}\n            block\n            style={{ display: 'block', marginTop: '0.5rem' }}\n          >\n            Go\n          </Button>\n        </Col>\n      </Row>\n    </>\n  );\n};\n","const pad = (n: number): string => {\n  return `0${n}`.slice(-2);\n};\n\n/**\n * 順位の数値から順位文字列に変換する\n * @param x 順位\n * @returns 順位文字列\n */\nexport const getOrdinal = (x: number): string => {\n  const s = ['th', 'st', 'nd', 'rd'];\n  const v = x % 100;\n  return `${x}${s[(v - 20) % 10] || s[v] || s[0]}`;\n};\n\nexport const formatDate = (d: Date): string => {\n  const year = String(d.getFullYear());\n  const month = pad(d.getMonth() + 1);\n  const date = pad(d.getDate());\n  return `${year}/${month}/${date}`;\n};\n\nconst DAYS = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'] as const;\n\n// 2021-08-14(Sat) 22:40\nexport const formatDatetime = (d: Date): string => {\n  const year = String(d.getFullYear());\n  const month = pad(d.getMonth() + 1);\n  const date = pad(d.getDate());\n  const day = DAYS[d.getDay()];\n  const hours = pad(d.getHours());\n  const minutes = pad(d.getMinutes());\n  return `${year}-${month}-${date}(${day}) ${hours}:${minutes}`;\n};\n\nexport const getPer = (x: number, l: number, r: number): number => {\n  return (x - l) / (r - l);\n};\n\n/**\n * returns array [start, start+1, ..., end].\n *\n * @param {number} start start number\n * @param {number} end end number\n * @returns {number[]} array\n */\nexport const range = (start: number, end: number): number[] =>\n  Array.from({ length: end - start + 1 }, (v, k) => k + start);\n\n/**\n * 増減値を文字列に変換する\n * @param x 増減値\n * @returns 増減値を表す文字列\n */\nexport const getDiff = (x: number): string => {\n  const sign = x === 0 ? '±' : x < 0 ? '-' : '+';\n  return `${sign}${Math.abs(x)}`;\n};\n\nexport const getHashtagSet = (slug: string): string[] => {\n  const hashtags = ['#AtCoder'];\n  if (slug.startsWith('ahc')) {\n    hashtags.push(`#${slug.toUpperCase()}`);\n  } else if (slug === 'rcl-contest-2021-long') {\n    hashtags.push('#R_procon');\n  }\n  return hashtags;\n};\n","export class BinaryIndexedTree {\n  data: number[];\n  length: number;\n  constructor(_length: number) {\n    this.length = _length;\n    this.data = (Array(++_length) as number[]).fill(0);\n  }\n  sum(k: number): number {\n    let ret = 0;\n    for (++k; k > 0; k -= k & -k) ret += this.data[k];\n    return ret;\n  }\n  add(k: number, x: number): void {\n    for (++k; k < this.data.length; k += k & -k) this.data[k] += x;\n  }\n  // query for [l, r)\n  query(l: number, r: number): number {\n    return this.sum(r - 1) - this.sum(l - 1);\n  }\n}\n","import { BinaryIndexedTree } from './BinaryIndexedTree';\nimport { ContestResults } from './Data';\n\nexport const STEP_SIZE = 400;\nexport const COLORS: [number, string, number, number][] = [\n  [0, '#808080', 0.15, 0x808080],\n  [400, '#804000', 0.15, 0x804000],\n  [800, '#008000', 0.15, 0x008000],\n  [1200, '#00C0C0', 0.2, 0x00c0c0],\n  [1600, '#0000FF', 0.1, 0x0000ff],\n  [2000, '#C0C000', 0.25, 0xc0c000],\n  [2400, '#FF8000', 0.2, 0xff8000],\n  [2800, '#FF0000', 0.1, 0xff0000],\n];\n\n/**\n * レーティング x に関する色情報を返す\n * @param x レーティング\n * @returns [レーティング下限値，色文字列，アルファ値，色数値]\n */\nexport const getColor = (x: number): [number, string, number, number] => {\n  for (let i = COLORS.length - 1; i >= 0; i--) {\n    if (x >= COLORS[i][0]) return COLORS[i];\n  }\n  return [-1, '#000000', 0.1, 0x000000];\n};\n\n/**\n * 同色レーティング帯のうち何割の位置にいるかを求める\n * @param x レーティング値\n * @returns 割合\n */\nexport const getRatingPer = (x: number): number => {\n  let pre = COLORS[COLORS.length - 1][0] + STEP_SIZE;\n  for (let i = COLORS.length - 1; i >= 0; i--) {\n    if (x >= COLORS[i][0]) return (x - COLORS[i][0]) / (pre - COLORS[i][0]);\n    pre = COLORS[i][0];\n  }\n  return 0;\n};\n\nexport interface RankingEntry {\n  rank: number;\n  rating: number;\n  username: string;\n  win: number;\n  match: number;\n}\n\nconst MAX_RATING = 10000;\nexport class RatingRanks {\n  bit: BinaryIndexedTree;\n  user2rating: Map<string, RankingEntry>;\n  // userid => [rating, rank][]\n  user2ratingRankHistory: Map<string, [number, number][]>;\n  ratings: number[];\n\n  constructor(contestResultsArray?: (ContestResults | undefined)[]) {\n    this.bit = new BinaryIndexedTree(MAX_RATING);\n    this.user2rating = new Map<string, RankingEntry>();\n    this.user2ratingRankHistory = new Map<string, [number, number][]>();\n    if (contestResultsArray === undefined) {\n      this.ratings = [];\n      return;\n    }\n    contestResultsArray.forEach((contestResults) => {\n      if (contestResults === undefined) return;\n\n      // レーティング更新の反映\n      for (const username in contestResults) {\n        const rankingEntry = this.user2rating.get(username);\n        if (rankingEntry !== undefined) {\n          const oldRating = rankingEntry.rating;\n          rankingEntry.rating = contestResults[username].NewRating;\n          rankingEntry.match++;\n          if (contestResults[username].Place === 1) {\n            rankingEntry.win++;\n          }\n          this.bit.add(oldRating, -1);\n          this.bit.add(contestResults[username].NewRating, 1);\n        } else {\n          this.user2rating.set(username, {\n            rank: -1,\n            rating: contestResults[username].NewRating,\n            username,\n            win: contestResults[username].Place === 1 ? 1 : 0,\n            match: 1,\n          });\n          this.bit.add(contestResults[username].NewRating, 1);\n        }\n      }\n\n      // ランキング更新\n      this.user2rating.forEach(\n        (rankingEntry: RankingEntry, username: string) => {\n          const rank = this.bit.query(rankingEntry.rating + 1, MAX_RATING) + 1;\n          rankingEntry.rank = rank;\n          if (this.user2ratingRankHistory.has(username)) {\n            this.user2ratingRankHistory\n              .get(username)\n              ?.push([rankingEntry.rating, rank]);\n          } else {\n            this.user2ratingRankHistory.set(username, [\n              [rankingEntry.rating, rank],\n            ]);\n          }\n        }\n      );\n    });\n    this.ratings = Array.from(this.user2rating.values()).map(\n      (rankingEntry) => rankingEntry.rating\n    );\n    this.ratings.sort((a, b) => b - a);\n  }\n\n  getRank(username: string): number {\n    const ratingAndRank = this.user2ratingRankHistory.get(username);\n    if (ratingAndRank === undefined) return -1;\n    return ratingAndRank[ratingAndRank.length - 1][1];\n  }\n\n  getRating(username: string): number {\n    return this.user2rating.get(username)?.rating ?? 0;\n  }\n\n  getHistogram(): [number[], number[]] {\n    const xaxis = [\n      0, 1, 2, 3, 4, 5, 7, 9, 12, 15, 19, 25, 32, 42, 54, 69, 89, 114, 147, 188,\n      242, 311, 400,\n    ];\n    // 400 以降は 100 区切りで 10000 まで追加しておく\n    for (let x = 500; x < 10000; x += 100) {\n      xaxis.push(x);\n    }\n    const data = Array(xaxis.length) as number[];\n    data.fill(0);\n\n    // 区切りごとに個数を数える\n    this.ratings.forEach((rating) => {\n      const index: number = xaxis.findIndex(\n        (x, i) => x <= rating && rating < xaxis[i + 1]\n      );\n      if (index === -1) return;\n      data[index]++;\n    });\n\n    // 0 要素を後ろから削る\n    while (data[data.length - 1] === 0) {\n      data.pop();\n      xaxis.pop();\n    }\n    return [xaxis, data];\n  }\n\n  /** get {rank, rating, username, win, match}[] */\n  getRanking(): RankingEntry[] {\n    const ratingAndUsername = Array.from(this.user2rating.values());\n    ratingAndUsername.sort((a, b) => {\n      if (a.rating != b.rating) return b.rating - a.rating;\n      else if (a.username < b.username) return -1;\n      else return 1;\n    });\n    return ratingAndUsername;\n  }\n}\n","import React from 'react';\nimport { RatingHistoryEntry } from '../../interfaces/RatingHistoryEntry';\nimport { formatDate, getOrdinal } from '../../utils';\nimport { getColor, RatingRanks } from '../../utils/Rating';\n\ninterface Props {\n  paramUser: string;\n  ratingHistory: RatingHistoryEntry[];\n  ratingRanks: RatingRanks;\n}\n\nexport const UserInfoTable: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory, ratingRanks } = props;\n  if (ratingHistory.length === 0) {\n    return <></>;\n  }\n  const lastResult = ratingHistory[ratingHistory.length - 1];\n  const lastCompeted = new Date(lastResult.EndTime * 1000);\n  const rank = ratingRanks.getRank(paramUser);\n  const ratingColor = getColor(lastResult.NewRating)[1];\n\n  return (\n    <>\n      <h3 style={{ fontSize: '24px' }}>Contest Status</h3>\n      <hr />\n      <table className=\"dl-table\" style={{ fontSize: '14px' }}>\n        <tr>\n          <th className=\"no-break\">Name</th>\n          <td>{paramUser}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rank</th>\n          <td>{getOrdinal(rank)}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rating</th>\n          <td>\n            <span style={{ color: ratingColor }}>{lastResult.NewRating}</span>\n          </td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Rated Matches</th>\n          <td>{ratingHistory.length}</td>\n        </tr>\n        <tr>\n          <th className=\"no-break\">Last Competed</th>\n          <td>{formatDate(lastCompeted)}</td>\n        </tr>\n      </table>\n    </>\n  );\n};\n","import { Contest } from '../interfaces/Contest';\nimport { RatingHistoryEntryEx } from '../interfaces/RatingHistoryEntry';\n\nlet CONTESTS: Contest[] | undefined = undefined;\nexport const fetchContests = async (): Promise<Contest[]> =>\n  CONTESTS === undefined\n    ? fetch(`${process.env.PUBLIC_URL}/json/contests/contests.json`)\n        .catch((e) => {\n          throw Error(e);\n        })\n        .then(async (r) => {\n          CONTESTS = (await r.json()) as Contest[];\n          return CONTESTS;\n        })\n    : Promise.resolve(CONTESTS);\n\nexport type ContestResults = { [key: string]: RatingHistoryEntryEx };\nconst CONTEST_RESULTS_MAP: Map<string, ContestResults> = new Map<\n  string,\n  ContestResults\n>();\nexport const fetchContestResults = async (\n  contest?: string\n): Promise<ContestResults | undefined> =>\n  contest !== undefined && contest.length > 0\n    ? !CONTEST_RESULTS_MAP.has(contest)\n      ? fetch(`${process.env.PUBLIC_URL}/json/results/${contest}.json`)\n          .catch((e) => {\n            throw Error(e);\n          })\n          .then(async (r) => {\n            const submissions = (await r.json()) as ContestResults;\n            CONTEST_RESULTS_MAP.set(contest, submissions);\n            return submissions;\n          })\n      : Promise.resolve(CONTEST_RESULTS_MAP.get(contest) as ContestResults)\n    : Promise.resolve(undefined);\n","import * as PIXI from 'pixi.js';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\n\nexport const newGraphics = (\n  parent: PIXI.Graphics | PIXI.Container\n): Graphics => {\n  const s = new Graphics();\n  parent.addChild(s);\n  return s;\n};\n\nexport const newText = (\n  parent: PIXI.Container,\n  x: number,\n  y: number,\n  font: string,\n  fontSize: number\n): PIXI.Text => {\n  const t = new PIXI.Text(\n    '',\n    new PIXI.TextStyle({\n      fontFamily: font,\n      fontSize: fontSize,\n      fill: 0x000000,\n    })\n  );\n  t.x = x;\n  t.y = y;\n  t.anchor.x = 0.5;\n  t.anchor.y = 0.5;\n  parent.addChild(t);\n  return t;\n};\n","import * as PIXI from 'pixi.js';\nimport { newGraphics, newText } from '../../utils/Shape';\nimport { getColor, getRatingPer } from '../../utils/Rating';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { getDiff, getOrdinal } from '../../utils';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\nimport { ChartCanvasMode } from './ChartCanvas';\n\nexport const LABEL_FONT_FAMILY = 'Lato';\nexport const RATING_FONT_FAMILY = 'Squada One';\n\nconst OFFSET_X = 50;\nconst OFFSET_Y = 5;\nconst STATUS_WIDTH = 640 - OFFSET_X - 10;\nconst STATUS_HEIGHT = 80 - OFFSET_Y - 5;\n\nconst STAR_MIN = 3200;\nconst PARTICLE_MIN = 3;\nconst PARTICLE_MAX = 20;\nconst LIFE_MAX = 30;\n\nclass Particle {\n  object: PIXI.Text;\n  angle: number;\n  speed: number;\n  velocityX: number;\n  velocityY: number;\n  rotateSpeed: number;\n  life: number;\n  initialX: number;\n  initialY: number;\n\n  constructor(statusContainer: PIXI.Container, x: number, y: number) {\n    this.initialX = x;\n    this.initialY = y;\n    this.object = newText(statusContainer, 0, 0, LABEL_FONT_FAMILY, 64);\n    this.angle = 0;\n    this.speed = 0;\n    this.velocityX = 0;\n    this.velocityY = 0;\n    this.rotateSpeed = 0;\n    this.life = 0;\n    this.object.x = this.initialX;\n    this.object.y = this.initialY;\n  }\n\n  set(color: number, alpha: number, useStar: boolean) {\n    this.object.x = this.initialX;\n    this.object.y = this.initialY;\n    this.angle = Math.random() * Math.PI * 2;\n    this.speed = Math.random() * 4 + 4;\n    this.velocityX = Math.cos(this.angle) * this.speed;\n    this.velocityY = Math.sin(this.angle) * this.speed;\n    this.rotateSpeed = Math.random() * 20 + 10;\n    this.life = LIFE_MAX;\n    this.object.visible = true;\n    this.object.style.fill = color;\n    this.object.text = useStar ? '★' : '@';\n    this.object.alpha = alpha;\n  }\n\n  disable() {\n    this.life = 0;\n    this.object.visible = false;\n  }\n\n  update() {\n    if (this.life <= 0) {\n      this.object.visible = false;\n      return;\n    }\n    this.object.x += this.velocityX;\n    this.velocityX *= 0.9;\n    this.object.y += this.velocityY;\n    this.velocityY *= 0.9;\n    this.life--;\n    this.object.scale.x = this.object.scale.y = this.life / LIFE_MAX;\n    this.object.rotation += this.rotateSpeed;\n  }\n}\n\nclass Particles {\n  particles: Particle[];\n\n  constructor(statusContainer: PIXI.Container, x: number, y: number) {\n    this.particles = [];\n    for (let i = 0; i < PARTICLE_MAX; ++i) {\n      this.particles.push(new Particle(statusContainer, x, y));\n    }\n  }\n\n  set(num: number, color: number, alpha: number, rating: number) {\n    const useStar = rating >= STAR_MIN;\n    this.particles.forEach((particle, index) => {\n      if (index < num) {\n        particle.set(color, alpha, useStar);\n      } else {\n        particle.disable();\n      }\n    });\n  }\n\n  update() {\n    this.particles.forEach((particle) => {\n      if (particle.life > 0) {\n        particle.update();\n      }\n    });\n  }\n}\n\nexport class StatusCanvas {\n  app: PIXI.Application;\n  statusContainer?: PIXI.Container;\n  borderGraphics!: Graphics;\n  ratingText!: PIXI.Text;\n  placeText!: PIXI.Text;\n  diffText!: PIXI.Text;\n  dateText!: PIXI.Text;\n  contestNameText!: PIXI.Text;\n\n  particles?: Particles;\n  standingsUrl: string;\n\n  mode: ChartCanvasMode;\n\n  constructor(app: PIXI.Application, mode: ChartCanvasMode) {\n    this.app = app;\n    this.statusContainer = undefined;\n    this.standingsUrl = '';\n    this.mode = mode;\n\n    this.app.ticker.maxFPS = 60;\n    this.app.ticker.add(() => {\n      this.animate();\n    });\n  }\n\n  destroy(): void {\n    if (this.statusContainer) {\n      this.statusContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.statusContainer = undefined;\n    }\n  }\n\n  init(): void {\n    this.destroy();\n    this.statusContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.statusContainer);\n\n    this.borderGraphics = newGraphics(this.statusContainer);\n    this.ratingText = newText(\n      this.statusContainer,\n      OFFSET_X + 75,\n      OFFSET_Y + STATUS_HEIGHT / 2,\n      RATING_FONT_FAMILY,\n      48\n    );\n    this.placeText = newText(\n      this.statusContainer,\n      OFFSET_X + 160,\n      OFFSET_Y + STATUS_HEIGHT / 2.7,\n      LABEL_FONT_FAMILY,\n      16\n    );\n    this.diffText = newText(\n      this.statusContainer,\n      OFFSET_X + 160,\n      OFFSET_Y + STATUS_HEIGHT / 1.5,\n      LABEL_FONT_FAMILY,\n      11\n    );\n    this.diffText.style.fill = 0x888888;\n    this.dateText = newText(\n      this.statusContainer,\n      OFFSET_X + 200,\n      OFFSET_Y + STATUS_HEIGHT / 4,\n      LABEL_FONT_FAMILY,\n      14\n    );\n    this.contestNameText = newText(\n      this.statusContainer,\n      OFFSET_X + 200,\n      OFFSET_Y + STATUS_HEIGHT / 1.6,\n      LABEL_FONT_FAMILY,\n      20\n    );\n    this.dateText.anchor.x = 0.0;\n    this.contestNameText.anchor.x = 0.0;\n    if (this.contestNameText.width > STATUS_WIDTH - 200 - 10) {\n      this.contestNameText.scale.x =\n        (STATUS_WIDTH - 200 - 10) / this.contestNameText.width;\n    }\n\n    this.contestNameText.interactive = true;\n    this.contestNameText.cursor = 'pointer';\n    this.contestNameText.on('click', () => {\n      window.location.href = this.standingsUrl;\n    });\n\n    this.particles = new Particles(\n      this.statusContainer,\n      this.ratingText.x,\n      this.ratingText.y\n    );\n  }\n\n  set(data: RatingHistoryEntryEx, particle_flag: boolean): void {\n    if (!this.particles) return;\n    const date = new Date(data.EndTime * 1000);\n    const rating = this.mode === 'Rating' ? data.NewRating : data.performance;\n    const old_rating: number | null =\n      this.mode === 'Rating' ? data.OldRating : null;\n    const place = data.Place;\n    const contest_name = data.ContestName;\n    const tmp = getColor(rating);\n    const color = tmp[3],\n      alpha = tmp[2];\n    this.borderGraphics\n      .clear()\n      .lineStyle(1.0, color)\n      .drawRoundedRect(OFFSET_X, OFFSET_Y, STATUS_WIDTH, STATUS_HEIGHT, 2);\n    this.ratingText.text = String(rating);\n    this.ratingText.style.fill = color;\n    this.placeText.text = getOrdinal(place);\n    this.diffText.text =\n      old_rating !== null ? getDiff(rating - old_rating) : '-';\n    this.dateText.text = date.toLocaleDateString();\n    this.contestNameText.text = contest_name;\n    this.contestNameText.scale.x = 1.0;\n    if (this.contestNameText.width > STATUS_WIDTH - 200 - 10) {\n      this.contestNameText.scale.x =\n        (STATUS_WIDTH - 200 - 10) / this.contestNameText.width;\n    }\n    if (particle_flag) {\n      const particleNum = Math.floor(\n        Math.pow(getRatingPer(rating), 2) * (PARTICLE_MAX - PARTICLE_MIN) +\n          PARTICLE_MIN\n      );\n      this.particles.set(particleNum, color, alpha, rating);\n    }\n    this.standingsUrl = data.StandingsUrl;\n  }\n\n  animate(): void {\n    if (!this.particles) return;\n    this.particles.update();\n  }\n}\n","import * as PIXI from 'pixi.js';\nimport { DropShadowFilter } from '@pixi/filter-drop-shadow';\nimport { getPer } from '../../utils';\nimport { newGraphics } from '../../utils/Shape';\nimport { getColor } from '../../utils/Rating';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\n\nconst OFFSET_X = 40;\nconst OFFSET_Y = 20;\nconst MARGIN_Y_PER = 1.1;\nconst STEP = 20;\nconst PANEL_WIDTH = 640 - OFFSET_X - 12;\nconst PANEL_HEIGHT = 480 - OFFSET_Y - 30;\n\n// additional\nconst LABEL_FONT_FAMILY = 'Lato';\n\nexport class RatingDistributionChartCanvas {\n  app: PIXI.Application;\n  chartContainer?: PIXI.Container;\n  chartGraphics?: Graphics;\n  labelTextStyle!: PIXI.TextStyle;\n\n  n!: number;\n  xaxis!: number[];\n  data!: number[];\n  rating!: number;\n\n  yMax!: number;\n\n  lineGraphics?: Graphics;\n  ratingText?: PIXI.Text;\n\n  constructor(app: PIXI.Application) {\n    this.app = app;\n    this.chartContainer = undefined;\n    // void this.init();\n  }\n\n  destroy(): void {\n    if (this.chartContainer) {\n      this.chartContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.chartContainer = undefined;\n    }\n  }\n\n  init(xaxis: number[], data: number[], rating: number): void {\n    this.destroy();\n    this.chartContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.chartContainer);\n\n    if (data.length !== xaxis.length) {\n      throw new Error('長さ不一致');\n    }\n    this.xaxis = xaxis;\n    this.data = data;\n    this.rating = rating;\n\n    this.n = data.length;\n    if (this.n == 0) return;\n    this.xaxis.push(this.xaxis[this.n - 1] + 100);\n\n    this.yMax =\n      this.data.reduce((prev, curr) => Math.max(prev, curr), 0) * MARGIN_Y_PER;\n\n    this.labelTextStyle = new PIXI.TextStyle({\n      fontFamily: LABEL_FONT_FAMILY,\n      fontSize: 12,\n      fill: 0x000000,\n    });\n\n    void this.initBackground();\n    void this.initChart();\n  }\n\n  initBackground(): void {\n    if (this.chartContainer === undefined) return;\n\n    const panelGraphics = newGraphics(this.chartContainer);\n    panelGraphics.x = OFFSET_X;\n    panelGraphics.y = OFFSET_Y;\n    panelGraphics.alpha = 0.3;\n    const borderGraphics = newGraphics(this.chartContainer);\n    borderGraphics.x = OFFSET_X;\n    borderGraphics.y = OFFSET_Y;\n\n    const newLabelY = (s: string, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = OFFSET_X - 10;\n      t.y = OFFSET_Y + y;\n      t.anchor.x = 1.0;\n      t.anchor.y = 0.5;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    const newLabelX = (s: string, x: number): PIXI.Text => {\n      const t = new PIXI.Text(\n        s,\n        new PIXI.TextStyle({\n          fontFamily: LABEL_FONT_FAMILY,\n          fontSize: 10,\n          fill: 0x000000,\n        })\n      );\n      t.x = OFFSET_X + x;\n      t.y = OFFSET_Y + PANEL_HEIGHT + 3;\n      t.anchor.x = 0.0;\n      t.anchor.y = 0.5;\n      t.angle = 90;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    // y 軸ラベルとグリッド線を追加する\n    borderGraphics.lineStyle(1.0, 0xdddddd);\n    for (let i = STEP; i < this.yMax; i += STEP) {\n      const y = PANEL_HEIGHT - PANEL_HEIGHT * getPer(i, 0, this.yMax);\n      borderGraphics.moveTo(0, y).lineTo(PANEL_WIDTH, y);\n      newLabelY(String(i), y);\n    }\n\n    // x 軸ラベルを追加する\n    for (let i = 0; i < this.n; i += 2) {\n      const x = PANEL_WIDTH * getPer(i, 0, this.n);\n      newLabelX(String(this.xaxis[i]), x);\n    }\n\n    borderGraphics\n      .lineStyle(1.5, 0x888888)\n      .drawRoundedRect(0, 0, PANEL_WIDTH, PANEL_HEIGHT, 2);\n  }\n\n  newText(\n    parent: Graphics,\n    x: number,\n    y: number,\n    font: PIXI.TextStyle\n  ): PIXI.Text {\n    const t = new PIXI.Text('', font);\n    t.x = x;\n    t.y = y;\n    t.anchor.x = 0.5;\n    t.anchor.y = 0.5;\n    parent.addChild(t);\n    return t;\n  }\n\n  initChart(): void {\n    if (this.chartContainer === undefined) return;\n\n    this.chartGraphics = newGraphics(this.chartContainer);\n    const dropShadowFilter = new DropShadowFilter();\n    dropShadowFilter.color = 0x000000;\n    dropShadowFilter.alpha = 0.3;\n    dropShadowFilter.distance = Math.hypot(1, 2);\n    dropShadowFilter.angle = Math.atan2(1, 2);\n    dropShadowFilter.blur = 3;\n    this.chartGraphics.filters = [dropShadowFilter];\n\n    // マウスオーバー時に表示する線と数字を用意する\n    const countText = this.newText(\n      this.chartGraphics,\n      0,\n      0,\n      new PIXI.TextStyle({\n        fontFamily: LABEL_FONT_FAMILY,\n        fontSize: 10,\n        fill: 0x000000,\n      })\n    );\n    countText.visible = false;\n    const countGraphics = newGraphics(this.chartContainer);\n    countGraphics\n      .lineStyle(1.0, 0xdddddd)\n      .moveTo(0, 20)\n      .lineTo(0, PANEL_HEIGHT);\n    countGraphics.y = OFFSET_Y;\n    countGraphics.visible = false;\n    const mouseover = (i: number): void => {\n      const x = OFFSET_X + PANEL_WIDTH * getPer(i + 0.5, 0, this.n);\n      countText.text = `${this.data[i]}`;\n      countText.style.fill = getColor(this.xaxis[i])[1];\n      countText.x = x;\n      countText.y = OFFSET_Y + 10;\n      countGraphics.x = x;\n      countText.visible = true;\n      countGraphics.visible = true;\n    };\n    const mouseout = (): void => {\n      countText.visible = false;\n      countGraphics.visible = false;\n    };\n\n    // ヒストグラム本体を描画する\n    for (let i = 0; i < this.n; ++i) {\n      const histogramGraphics = newGraphics(this.chartGraphics);\n\n      const rectHeight = PANEL_HEIGHT * getPer(this.data[i], 0, this.yMax);\n\n      const x0 = Math.floor(OFFSET_X + PANEL_WIDTH * getPer(i, 0, this.n));\n      const x1 = Math.floor(OFFSET_X + PANEL_WIDTH * getPer(i + 1, 0, this.n));\n      histogramGraphics.x = x0;\n      histogramGraphics.y = OFFSET_Y + PANEL_HEIGHT - rectHeight;\n      histogramGraphics\n        .lineStyle(0.5, 0xffffff)\n        .beginFill(getColor(this.xaxis[i])[3])\n        .drawRect(0, 0, x1 - x0 - 1, rectHeight);\n\n      const hitAreaRect = new PIXI.Rectangle(\n        0,\n        +rectHeight - PANEL_HEIGHT,\n        PANEL_WIDTH / this.n,\n        PANEL_HEIGHT\n      );\n      histogramGraphics.hitArea = hitAreaRect;\n      histogramGraphics.interactive = true;\n      histogramGraphics.on('mouseover', () => {\n        mouseover(i);\n      });\n      histogramGraphics.on('mouseout', () => {\n        mouseout();\n      });\n    }\n\n    // ユーザのレーティングを表す線を描画する\n    void this.initUserRatingLine(this.rating);\n  }\n\n  getXandColor(rating: number): [number, number] {\n    let x = PANEL_WIDTH;\n    let col = 0x000000;\n    for (let i = this.n - 1; i >= 0; i--) {\n      if (this.xaxis[i] <= rating) {\n        const per = getPer(rating + 0.5, this.xaxis[i], this.xaxis[i + 1]);\n        x = PANEL_WIDTH * getPer(i + per, 0, this.n);\n        col = getColor(this.xaxis[i])[3];\n        break;\n      }\n    }\n    return [x, col];\n  }\n\n  initUserRatingLine(rating: number): void {\n    if (this.chartContainer === undefined) return;\n    if (this.chartGraphics === undefined) return;\n\n    const [x, col] = this.getXandColor(rating);\n    this.lineGraphics = newGraphics(this.chartContainer);\n    this.lineGraphics\n      .lineStyle(1.0, 0x000000)\n      .moveTo(0, 0)\n      .lineTo(0, PANEL_HEIGHT);\n    this.lineGraphics.x = OFFSET_X + x;\n    this.lineGraphics.y = OFFSET_Y;\n    this.ratingText = this.newText(\n      this.chartGraphics,\n      OFFSET_X + x,\n      12,\n      new PIXI.TextStyle({\n        fontFamily: LABEL_FONT_FAMILY,\n        fontSize: 11,\n        fill: col,\n      })\n    );\n    this.ratingText.text = String(rating);\n  }\n\n  updateUserRatingLine(rating: number): void {\n    this.rating = rating;\n    if (this.lineGraphics === undefined) return;\n    if (this.ratingText === undefined) return;\n\n    this.lineGraphics.x = OFFSET_X + this.getXandColor(rating)[0];\n    this.ratingText.text = String(rating);\n  }\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport useFontFaceObserver from 'use-font-face-observer';\nimport * as PIXI from 'pixi.js';\nimport { LABEL_FONT_FAMILY, RATING_FONT_FAMILY } from './StatusCanvas';\nimport { RatingDistributionChartCanvas } from './RatingDistributionChartCanvas';\n\ninterface Props {\n  xaxis: number[];\n  data: number[];\n  rating: number;\n}\n\nexport const RatingDistributionGraph: React.FC<Props> = (props) => {\n  const { xaxis, data, rating } = props;\n  const isFontListLoaded = useFontFaceObserver([\n    { family: RATING_FONT_FAMILY },\n    { family: LABEL_FONT_FAMILY },\n  ]);\n  const chartCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const [canvas, setCanvas] = useState<RatingDistributionChartCanvas>();\n\n  useEffect(() => {\n    const chartCanvas: HTMLCanvasElement | null = chartCanvasRef.current;\n    if (chartCanvas === null) return;\n\n    const _chartApp = new PIXI.Application({\n      width: 640,\n      height: 480,\n      view: chartCanvas,\n      antialias: true,\n    });\n    _chartApp.renderer.backgroundColor = 0xffffff;\n\n    const _chartCanvas = new RatingDistributionChartCanvas(_chartApp);\n    setCanvas(_chartCanvas);\n  }, []);\n\n  useEffect(() => {\n    if (!isFontListLoaded) return;\n    if (!data) return;\n    if (!canvas) return;\n\n    if (data.length === 0) {\n      canvas.destroy();\n      return;\n    }\n    canvas.init(xaxis, data, rating);\n  }, [isFontListLoaded, data, canvas]);\n\n  return (\n    <>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '480px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={chartCanvasRef}\n          width=\"640\"\n          height=\"480\"\n        ></canvas>\n      </div>\n    </>\n  );\n};\n","import * as PIXI from 'pixi.js';\nimport { DropShadowFilter } from '@pixi/filter-drop-shadow';\nimport { StatusCanvas } from './StatusCanvas';\nimport { getPer } from '../../utils';\nimport { newGraphics } from '../../utils/Shape';\nimport { SmoothGraphics as Graphics } from '@pixi/graphics-smooth';\nimport { COLORS, STEP_SIZE, getColor } from '../../utils/Rating';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\n\nconst MARGIN_VAL_X = 86400 * 30;\nconst MARGIN_VAL_Y_LOW = 100;\nconst MARGIN_VAL_Y_HIGH = 300;\nconst OFFSET_X = 50;\nconst OFFSET_Y = 5;\nconst PANEL_WIDTH = 640 - OFFSET_X - 10;\nconst PANEL_HEIGHT = 360 - OFFSET_Y - 30;\nconst HIGHEST_WIDTH = 80;\nconst HIGHEST_HEIGHT = 20;\nconst START_YEAR = 2010;\nconst MONTH_NAMES = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n];\nconst YEAR_SEC = 86400 * 365;\n\n// additional\nconst LABEL_FONT_FAMILY = 'Lato';\n\nconst MODES = ['Rating', 'Performance'] as const;\nexport type ChartCanvasMode = typeof MODES[number];\n\nexport class ChartCanvas {\n  app: PIXI.Application;\n  chartContainer?: PIXI.Container;\n  x_min!: number;\n  x_max!: number;\n  y_min!: number;\n  y_max!: number;\n  labelTextStyle!: PIXI.TextStyle;\n  R!: number;\n  mode: ChartCanvasMode;\n\n  constructor(app: PIXI.Application, mode: ChartCanvasMode) {\n    this.app = app;\n    this.chartContainer = undefined;\n    this.mode = mode;\n    // void this.init();\n  }\n\n  destroy(): void {\n    if (this.chartContainer) {\n      this.chartContainer.destroy({\n        children: true,\n        texture: true,\n        baseTexture: true,\n      });\n      this.chartContainer = undefined;\n    }\n  }\n\n  getRating(ratingHistoryEntry: RatingHistoryEntryEx): number {\n    if (this.mode === 'Rating') return ratingHistoryEntry.NewRating;\n    else return ratingHistoryEntry.performance;\n  }\n\n  init(\n    ratingHistory: RatingHistoryEntryEx[],\n    statusCanvas: StatusCanvas\n  ): void {\n    this.destroy();\n    this.chartContainer = new PIXI.Container();\n    void this.app.stage.addChild(this.chartContainer);\n\n    this.R = 1.0;\n\n    this.x_min = 100000000000;\n    this.x_max = 0;\n    this.y_min = 10000;\n    this.y_max = 0;\n    ratingHistory.forEach((ratingHistoryEntry) => {\n      this.x_min = Math.min(this.x_min, ratingHistoryEntry.EndTime);\n      this.x_max = Math.max(this.x_max, ratingHistoryEntry.EndTime);\n      const rating = this.getRating(ratingHistoryEntry);\n      this.y_min = Math.min(this.y_min, rating);\n      this.y_max = Math.max(this.y_max, rating);\n    });\n    this.x_min -= MARGIN_VAL_X;\n    this.x_max += MARGIN_VAL_X;\n    this.y_min = Math.min(1500, Math.max(0, this.y_min - MARGIN_VAL_Y_LOW));\n    this.y_max += MARGIN_VAL_Y_HIGH;\n\n    this.labelTextStyle = new PIXI.TextStyle({\n      fontFamily: LABEL_FONT_FAMILY,\n      fontSize: 12 * this.R,\n      fill: 0x000000,\n    });\n\n    void this.initBackground();\n    void this.initChart(ratingHistory, statusCanvas);\n  }\n\n  initBackground(): void {\n    if (this.chartContainer === undefined) return;\n\n    const panelGraphics = new Graphics();\n    panelGraphics.x = OFFSET_X * this.R;\n    panelGraphics.y = OFFSET_Y * this.R;\n    panelGraphics.alpha = 0.3;\n    const borderGraphics = new Graphics();\n    borderGraphics.x = OFFSET_X * this.R;\n    borderGraphics.y = OFFSET_Y * this.R;\n\n    void this.chartContainer.addChild(panelGraphics);\n    void this.chartContainer.addChild(borderGraphics);\n\n    // 背景色を塗る\n    let y1 = 0;\n    for (let i = COLORS.length - 1; i >= 0; i--) {\n      const y2 =\n        PANEL_HEIGHT -\n        PANEL_HEIGHT * getPer(COLORS[i][0], this.y_min, this.y_max);\n      if (y2 > 0 && y1 < PANEL_HEIGHT) {\n        y1 = Math.max(y1, 0);\n        panelGraphics\n          .beginFill(COLORS[i][3])\n          .drawRect(\n            0,\n            y1 * this.R,\n            PANEL_WIDTH * this.R,\n            (Math.min(y2, PANEL_HEIGHT) - y1) * this.R\n          )\n          .endFill();\n      }\n      y1 = y2;\n    }\n\n    const newLabelY = (s: string, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = (OFFSET_X - 10) * this.R;\n      t.y = (OFFSET_Y + y) * this.R;\n      t.anchor.x = 1.0;\n      t.anchor.y = 0.5;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    const newLabelX = (s: string, x: number, y: number): PIXI.Text => {\n      const t = new PIXI.Text(s, this.labelTextStyle);\n      t.x = (OFFSET_X + x) * this.R;\n      t.y = (OFFSET_Y + PANEL_HEIGHT + 2 + y) * this.R;\n      t.anchor.x = 0.5;\n      t.anchor.y = 0.0;\n      if (this.chartContainer === undefined) return t;\n      return this.chartContainer.addChild(t);\n    };\n\n    // y 軸ラベルとグリッド線を追加する\n    for (let i = 0; i <= this.y_max; i += STEP_SIZE) {\n      if (i >= this.y_min) {\n        const y =\n          PANEL_HEIGHT - PANEL_HEIGHT * getPer(i, this.y_min, this.y_max);\n        void newLabelY(String(i), y);\n        borderGraphics.lineStyle(1.0 * this.R, 0xffffff);\n        if (i === 2000) borderGraphics.lineStyle(1.0 * this.R, 0x000000);\n        borderGraphics\n          .moveTo(0, y * this.R)\n          .lineTo(PANEL_WIDTH * this.R, y * this.R);\n      }\n    }\n    borderGraphics.lineStyle(1.0 * this.R, 0xffffff);\n\n    // x 軸ラベルとグリッド線を追加する\n    let month_step = 6;\n    for (let i = 3; i >= 1; i--) {\n      if (this.x_max - this.x_min <= YEAR_SEC * i + MARGIN_VAL_X * 2)\n        month_step = i;\n    }\n    let isFirst = true;\n    for (let i = START_YEAR; i < 3000; i++) {\n      let isEnded = false;\n      for (let j = 0; j < 12; j += month_step) {\n        const month = `0${j + 1}`.slice(-2);\n        const unix = Date.parse(`${i}-${month}-01T00:00:00`) / 1000;\n        if (this.x_min < unix && unix < this.x_max) {\n          const x = PANEL_WIDTH * getPer(unix, this.x_min, this.x_max);\n          if (j === 0 || isFirst) {\n            void newLabelX(MONTH_NAMES[j], x, 0);\n            void newLabelX(String(i), x, 13);\n            isFirst = false;\n          } else {\n            void newLabelX(MONTH_NAMES[j], x, 0);\n          }\n          borderGraphics\n            .moveTo(x * this.R, 0)\n            .lineTo(x * this.R, PANEL_HEIGHT * this.R);\n        }\n        if (unix > this.x_max) {\n          isEnded = true;\n          break;\n        }\n      }\n      if (isEnded) break;\n    }\n    borderGraphics\n      .lineStyle(1.5 * this.R, 0x888888)\n      .drawRoundedRect(\n        0,\n        0,\n        PANEL_WIDTH * this.R,\n        PANEL_HEIGHT * this.R,\n        2 * this.R\n      );\n  }\n\n  initChart(\n    ratingHistory: RatingHistoryEntryEx[],\n    statusGraphics: StatusCanvas\n  ): void {\n    if (this.chartContainer === undefined) return;\n\n    const chartGraphics = new Graphics();\n    this.chartContainer.addChild(chartGraphics);\n    // chart_container.shadow = new cj.Shadow(\"rgba(0,0,0,0.3)\", 1, 2, 3);\n    const dropShadowFilter = new DropShadowFilter();\n    dropShadowFilter.color = 0x000000;\n    dropShadowFilter.alpha = 0.3;\n    dropShadowFilter.distance = Math.hypot(1, 2) * this.R;\n    dropShadowFilter.angle = Math.atan2(1, 2);\n    dropShadowFilter.blur = 3 * this.R;\n    chartGraphics.filters = [dropShadowFilter];\n\n    const lineGraphics = newGraphics(chartGraphics);\n    const highestGraphics = newGraphics(chartGraphics);\n    highestGraphics.interactive = true;\n\n    const mouseoverVertex = (i: number): void => {\n      vertexGraphics[i].scale.x = vertexGraphics[i].scale.y = 1.2;\n      statusGraphics.set(ratingHistory[i], true);\n    };\n\n    const mouseoutVertex = (i: number): void => {\n      vertexGraphics[i].scale.x = vertexGraphics[i].scale.y = 1;\n    };\n    const { argmax: highestIdx } = ratingHistory.reduce(\n      ({ argmax, maxRating }, ratingHistoryEntry, index) => {\n        const rating = this.getRating(ratingHistoryEntry);\n        if (rating > maxRating) {\n          argmax = index;\n          maxRating = rating;\n        }\n        return { argmax, maxRating };\n      },\n      { argmax: 0, maxRating: 0 }\n    );\n\n    const vertexGraphics = ratingHistory.map((ratingHistoryEntry, index) => {\n      const vertex = newGraphics(chartGraphics);\n      vertex.lineStyle(1.0 * this.R, 0xffffff);\n      if (index === highestIdx) vertex.lineStyle(1.0 * this.R, 0x000000);\n      const rating = this.getRating(ratingHistoryEntry);\n      vertex.beginFill(getColor(rating)[3]).drawCircle(0, 0, 3.5 * this.R);\n      vertex.x =\n        (OFFSET_X +\n          PANEL_WIDTH *\n            getPer(ratingHistoryEntry.EndTime, this.x_min, this.x_max)) *\n        this.R;\n      vertex.y =\n        (OFFSET_Y +\n          (PANEL_HEIGHT -\n            PANEL_HEIGHT * getPer(rating, this.y_min, this.y_max))) *\n        this.R;\n      vertex.interactive = true;\n      vertex.on('mouseover', () => {\n        mouseoverVertex(index);\n      });\n      vertex.on('mouseout', () => {\n        mouseoutVertex(index);\n      });\n      return vertex;\n    });\n    {\n      let dx = 80 * this.R;\n      if ((this.x_min + this.x_max) / 2 < ratingHistory[highestIdx].EndTime)\n        dx = -80 * this.R;\n      const x = vertexGraphics[highestIdx].x + dx;\n      const y = vertexGraphics[highestIdx].y - 16;\n      highestGraphics\n        .lineStyle(1.0 * this.R, 0xffffff)\n        .moveTo(vertexGraphics[highestIdx].x, vertexGraphics[highestIdx].y)\n        .lineTo(x, y);\n      highestGraphics\n        .lineStyle(1.0 * this.R, 0x888888)\n        .beginFill(0xffffff)\n        .drawRoundedRect(\n          x - (HIGHEST_WIDTH / 2) * this.R,\n          y - (HIGHEST_HEIGHT / 2) * this.R,\n          HIGHEST_WIDTH * this.R,\n          HIGHEST_HEIGHT * this.R,\n          2 * this.R\n        );\n      const highest_text = new PIXI.Text(\n        `Highest: ${this.getRating(ratingHistory[highestIdx])}`,\n        this.labelTextStyle\n      );\n      highest_text.x = x;\n      highest_text.y = y;\n      highest_text.anchor.x = 0.5;\n      highest_text.anchor.y = 0.5;\n      this.chartContainer.addChild(highest_text);\n\n      highestGraphics.on('mouseover', () => {\n        mouseoverVertex(highestIdx);\n      });\n      highestGraphics.on('mouseout', () => {\n        mouseoutVertex(highestIdx);\n      });\n    }\n    // 折れ線を描画\n    (\n      [\n        [2.0, 0xaaaaaa],\n        [1.0, 0xffffff],\n      ] as [number, number][]\n    ).forEach(([width, color]) => {\n      lineGraphics.lineStyle(width * this.R, color);\n      lineGraphics.moveTo(vertexGraphics[0].x, vertexGraphics[0].y);\n      vertexGraphics.forEach((vertex) => {\n        lineGraphics.lineTo(vertex.x, vertex.y);\n      });\n    });\n  }\n}\n","import React, { useState, useEffect, useRef } from 'react';\nimport useFontFaceObserver from 'use-font-face-observer';\nimport * as PIXI from 'pixi.js';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { ChartCanvas, ChartCanvasMode } from './ChartCanvas';\nimport {\n  StatusCanvas,\n  LABEL_FONT_FAMILY,\n  RATING_FONT_FAMILY,\n} from './StatusCanvas';\n\ninterface Props {\n  ratingHistory?: RatingHistoryEntryEx[];\n  paramUser: string;\n  mode: ChartCanvasMode;\n}\n\nexport const RatingGraph: React.FC<Props> = (props) => {\n  const { ratingHistory, mode } = props;\n  const isFontListLoaded = useFontFaceObserver([\n    { family: RATING_FONT_FAMILY },\n    { family: LABEL_FONT_FAMILY },\n  ]);\n  const statusCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const chartCanvasRef = useRef<HTMLCanvasElement | null>(null);\n  const [canvases, setCanvases] = useState<[StatusCanvas, ChartCanvas]>();\n\n  const R = 1.0;\n  useEffect(() => {\n    const statusCanvas: HTMLCanvasElement | null = statusCanvasRef.current;\n    const chartCanvas: HTMLCanvasElement | null = chartCanvasRef.current;\n    if (statusCanvas === null || chartCanvas === null) return;\n\n    const _statusApp = new PIXI.Application({\n      width: 640,\n      height: 80,\n      view: statusCanvas,\n      antialias: true,\n    });\n    const _chartApp = new PIXI.Application({\n      width: 640 * R,\n      height: 360 * R,\n      view: chartCanvas,\n      antialias: true,\n    });\n\n    _statusApp.renderer.backgroundColor = 0xffffff;\n    _chartApp.renderer.backgroundColor = 0xffffff;\n\n    const _statusCanvas = new StatusCanvas(_statusApp, mode);\n    const _chartCanvas = new ChartCanvas(_chartApp, mode);\n\n    // _statusCanvas.init();\n    setCanvases([_statusCanvas, _chartCanvas]);\n  }, []);\n\n  useEffect(() => {\n    if (!isFontListLoaded) return;\n    if (!ratingHistory) return;\n    if (!canvases) return;\n\n    const [statusCanvas, chartCanvas] = canvases;\n    if (ratingHistory.length === 0) {\n      chartCanvas.destroy();\n      statusCanvas.destroy();\n      return;\n    }\n    const lastHistory = ratingHistory[ratingHistory.length - 1];\n\n    statusCanvas.init();\n    chartCanvas.init(ratingHistory, statusCanvas);\n    statusCanvas.set(lastHistory, false);\n  }, [isFontListLoaded, ratingHistory, canvases]);\n\n  return (\n    <>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '80px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={statusCanvasRef}\n          width=\"640\"\n          height=\"80\"\n        ></canvas>\n      </div>\n      <div>\n        <canvas\n          style={{\n            margin: '0px auto',\n            maxWidth: '640px',\n            maxHeight: '360px',\n            height: '100%',\n            width: '100%',\n            display: 'block',\n          }}\n          ref={chartCanvasRef}\n          width=\"640\"\n          height=\"360\"\n        ></canvas>\n      </div>\n    </>\n  );\n};\n","import React, { useState } from 'react';\nimport useSWR from 'swr';\nimport { Alert, Nav, NavItem } from 'reactstrap';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUser, faList } from '@fortawesome/free-solid-svg-icons';\nimport { FormBlock } from './FormBlock';\nimport { UserInfoTable } from './UserInfoTable';\nimport { Contest } from '../../interfaces/Contest';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport {\n  ContestResults,\n  fetchContestResults,\n  fetchContests,\n} from '../../utils/Data';\nimport { RatingRanks } from '../../utils/Rating';\nimport { ChartSection } from './ChartSection';\nimport './nav.scss';\nimport { HistoryTable } from './HistoryTable';\n\nenum ContentTab {\n  'chart' = 0,\n  'table' = 1,\n}\n\nconst ContentWrapper: React.FC<{\n  display: boolean;\n}> = (props) => <>{props.display ? props.children : <></>}</>;\n\nconst getNavClassName = (active: boolean): string => {\n  if (active) return 'active nav-link';\n  return 'nav-link';\n};\n\ninterface Props {\n  match: {\n    params: {\n      user: string;\n    };\n  };\n}\n\nexport const RatingPage: React.FC<Props> = (props) => {\n  const paramUser: string = props.match.params.user ?? '';\n  const [activeTab, setActiveTab] = useState<ContentTab>(ContentTab.chart);\n\n  const { data: contests, error: contestsError } = useSWR<Contest[], Error>(\n    '/json/contests/contests',\n    fetchContests\n  );\n  const { data: contestResultsArray, error: contestResultsArrayError } = useSWR<\n    (ContestResults | undefined)[],\n    Error\n  >(contests ? `/json/results/` : null, () => {\n    if (!contests) return Promise.resolve([undefined]);\n    const promises = contests.map((contest) =>\n      fetchContestResults(contest.slug)\n    );\n    return Promise.all(promises);\n  });\n\n  const ratingHistory =\n    paramUser && contestResultsArray\n      ? (contestResultsArray\n          .map((contestResults) => {\n            if (contestResults && paramUser in contestResults)\n              return contestResults[paramUser];\n            else return undefined;\n          })\n          .filter(\n            (contestResult) => contestResult !== undefined\n          ) as RatingHistoryEntryEx[])\n      : undefined;\n  const ratingRanks = new RatingRanks(contestResultsArray);\n\n  return (\n    <>\n      <h2>Description</h2>\n      <p>\n        AtCoder\n        で行われたマラソンコンテストのレーティング推移をグラフに表示します．\n      </p>\n      <p>\n        AtCoder\n        が公式にマラソンレートのグラフ表示機能を実装するまでのつなぎです．\n      </p>\n      <hr />\n\n      {contestsError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest list.\n        </Alert>\n      ) : contests === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest data...\n        </div>\n      ) : contestResultsArrayError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest results.\n        </Alert>\n      ) : contestResultsArray === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest results...\n        </div>\n      ) : (\n        <></>\n      )}\n      <FormBlock paramUser={paramUser} />\n      <hr />\n      {ratingHistory?.length ? (\n        <>\n          <Nav tabs className=\"justify-content-center\">\n            <NavItem>\n              <a\n                className={getNavClassName(activeTab === ContentTab.chart)}\n                onClick={() => {\n                  setActiveTab(ContentTab.chart);\n                }}\n              >\n                <FontAwesomeIcon style={{ marginRight: '4px' }} icon={faUser} />\n                Profile\n              </a>\n            </NavItem>\n            <NavItem>\n              <a\n                className={getNavClassName(activeTab === ContentTab.table)}\n                onClick={() => {\n                  setActiveTab(ContentTab.table);\n                }}\n              >\n                <FontAwesomeIcon style={{ marginRight: '4px' }} icon={faList} />\n                Competition History\n              </a>\n            </NavItem>\n          </Nav>\n          <ContentWrapper display={activeTab === ContentTab.chart}>\n            <div\n              style={{\n                maxWidth: '640px',\n                marginLeft: 'auto',\n                marginRight: 'auto',\n              }}\n            >\n              <UserInfoTable\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n                ratingRanks={ratingRanks}\n              />\n              <ChartSection\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n                ratingRanks={ratingRanks}\n              />\n            </div>\n          </ContentWrapper>\n          <ContentWrapper display={activeTab === ContentTab.table}>\n            <div className=\"container\">\n              <HistoryTable\n                paramUser={paramUser}\n                ratingHistory={ratingHistory}\n              />\n            </div>\n          </ContentWrapper>\n        </>\n      ) : (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          AtCoder ID is empty or invalid.\n        </Alert>\n      )}\n    </>\n  );\n};\n","export const RatingColors = [\n  'Black',\n  'Grey',\n  'Brown',\n  'Green',\n  'Cyan',\n  'Blue',\n  'Yellow',\n  'Orange',\n  'Red',\n] as const;\n\nexport type RatingColor = typeof RatingColors[number];\nexport const getRatingColor = (rating: number): RatingColor => {\n  const index = Math.min(Math.floor(rating / 400), RatingColors.length - 2);\n  return RatingColors[index + 1];\n};\nexport const getRatingColorCode = (ratingColor: RatingColor): string => {\n  switch (ratingColor) {\n    case 'Black':\n      return '#000000'; // black\n    case 'Grey':\n      return '#808080'; // grey\n    case 'Brown':\n      return '#804000'; // brown\n    case 'Green':\n      return '#008000'; // green\n    case 'Cyan':\n      return '#00C0C0'; // cyan\n    case 'Blue':\n      return '#0000FF'; // blue\n    case 'Yellow':\n      return '#C0C000'; // yellow\n    case 'Orange':\n      return '#FF8000'; // orange\n    case 'Red':\n      return '#FF0000'; // red\n  }\n};\n\nexport type RatingColorClassName =\n  | 'difficulty-black'\n  | 'difficulty-grey'\n  | 'difficulty-brown'\n  | 'difficulty-green'\n  | 'difficulty-cyan'\n  | 'difficulty-blue'\n  | 'difficulty-yellow'\n  | 'difficulty-orange'\n  | 'difficulty-red';\nexport const getRatingColorClass = (rating: number): RatingColorClassName => {\n  const ratingColor = getRatingColor(rating);\n  switch (ratingColor) {\n    case 'Black':\n      return 'difficulty-black';\n    case 'Grey':\n      return 'difficulty-grey';\n    case 'Brown':\n      return 'difficulty-brown';\n    case 'Green':\n      return 'difficulty-green';\n    case 'Cyan':\n      return 'difficulty-cyan';\n    case 'Blue':\n      return 'difficulty-blue';\n    case 'Yellow':\n      return 'difficulty-yellow';\n    case 'Orange':\n      return 'difficulty-orange';\n    case 'Red':\n      return 'difficulty-red';\n  }\n};\n\nexport const getRatingColorBG = (rating: number): string => {\n  const ratingColor = getRatingColor(rating);\n  switch (ratingColor) {\n    case 'Black':\n      return '#D9D9D9';\n    case 'Grey':\n      return '#D9D9D9';\n    case 'Brown':\n      return '#D9C5B2';\n    case 'Green':\n      return '#B2D9B2';\n    case 'Cyan':\n      return '#B2ECEC';\n    case 'Blue':\n      return '#B2B2FF';\n    case 'Yellow':\n      return '#ECECB2';\n    case 'Orange':\n      return '#FFD9B2';\n    case 'Red':\n      return '#FFB2B2';\n  }\n};\n","import React from 'react';\nimport BootstrapTable, {\n  ColumnDescription,\n  SortOrder,\n} from 'react-bootstrap-table-next';\nimport filterFactory from 'react-bootstrap-table2-filter';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faSearch,\n  faSortAmountDown,\n  faSortAmountDownAlt,\n  faSort,\n} from '@fortawesome/free-solid-svg-icons';\nimport { RatingHistoryEntryEx } from '../../interfaces/RatingHistoryEntry';\nimport { formatDatetime, getDiff } from '../../utils';\nimport { getRatingColorBG } from '../../utils/RatingColor';\nimport { UncontrolledTooltip } from 'reactstrap';\nimport './history-table.scss';\n\nconst _sortCaret = (order: 'asc' | 'desc' | undefined): JSX.Element => {\n  if (order === 'asc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n        }}\n        icon={faSortAmountDown}\n      />\n    );\n  if (order === 'desc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n        }}\n        icon={faSortAmountDownAlt}\n      />\n    );\n  return (\n    <FontAwesomeIcon\n      style={{ marginLeft: '6px', opacity: 0.2 }}\n      icon={faSort}\n    />\n  );\n};\n\ninterface Props {\n  paramUser: string;\n  ratingHistory: RatingHistoryEntryEx[];\n}\n\nexport const HistoryTable: React.FC<Props> = (props) => {\n  const { paramUser, ratingHistory } = props;\n\n  const columns: ColumnDescription[] = [\n    {\n      dataField: 'EndTime',\n      text: 'Date',\n      sort: true,\n      formatter: function _formatter(cell: number) {\n        const date = new Date(cell * 1000);\n        return (\n          <>\n            <span>{formatDatetime(date)}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'ContestName',\n      text: 'Contest',\n      sort: true,\n      classes: 'history-table-contest',\n      formatter: function _formatter(cell: string, _row: RatingHistoryEntryEx) {\n        const btnId = `js-history-user-btn-submission-${_row.slug}`;\n        return (\n          <>\n            <a\n              href={`https://atcoder.jp/contests/${_row.slug}`}\n              target=\"_blank\"\n              rel=\"noreferrer\"\n            >\n              {cell}\n            </a>\n            <span className=\"history-user-btn\">\n              <a\n                href={`https://atcoder.jp/contests/${_row.slug}/submissions?f.User=${paramUser}`}\n                id={btnId}\n              >\n                <FontAwesomeIcon icon={faSearch} />\n              </a>\n              <UncontrolledTooltip placement=\"top\" target={btnId}>\n                {`view ${paramUser}'s submissions`}\n              </UncontrolledTooltip>\n            </span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: string, b: string, order: SortOrder) {\n        if (order === 'desc') {\n          return a > b ? 1 : -1;\n        } else {\n          return b < a ? -1 : 1;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'Place',\n      text: 'Rank',\n      sort: true,\n      formatter: function _formatter(cell: number, _row: RatingHistoryEntryEx) {\n        return (\n          <>\n            <a href={_row.StandingsUrl} target=\"_blank\" rel=\"noreferrer\">\n              {cell}\n            </a>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'performance',\n      text: 'Performance',\n      sort: true,\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      style: function _style(cell: number) {\n        return { backgroundColor: getRatingColorBG(cell) };\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'NewRating',\n      text: 'New Rating',\n      sort: true,\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      style: function _style(cell: number) {\n        return { backgroundColor: getRatingColorBG(cell) };\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'change',\n      text: 'Diff',\n      sort: true,\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{getDiff(cell)}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n  ];\n  const data = [...ratingHistory].reverse();\n\n  return (\n    <BootstrapTable\n      bootstrap4\n      classes=\"th-center th-middle td-center td-middle table-standings\"\n      striped\n      keyField=\"EndTime\"\n      filter={filterFactory()}\n      wrapperClasses=\"table-responsive\"\n      data={data}\n      columns={columns}\n    />\n  );\n};\n","import React from 'react';\nimport { PaginationOptions } from 'react-bootstrap-table-next';\nimport {\n  Col,\n  Pagination,\n  PaginationItem,\n  PaginationLink,\n  Row,\n} from 'reactstrap';\nimport { range } from '../utils';\nimport './pagination-panel.scss';\n\nconst pageList = (\n  currPage: number,\n  pageStartIndex: number,\n  totalPages: number\n): number[] => {\n  if (totalPages === 0) {\n    return [];\n  }\n  if (totalPages <= 10) {\n    return range(1, totalPages);\n  }\n\n  const pageNumbers = [currPage];\n  let tmpExp = 1;\n  for (;;) {\n    tmpExp *= 2;\n    const tmpPageNumber = currPage - tmpExp + 1;\n    if (tmpPageNumber < pageStartIndex) {\n      break;\n    }\n    pageNumbers.unshift(tmpPageNumber);\n  }\n  if (pageNumbers[0] !== pageStartIndex) {\n    pageNumbers.unshift(pageStartIndex);\n  }\n\n  tmpExp = 1;\n  for (;;) {\n    tmpExp *= 2;\n    const tmpPageNumber = currPage + tmpExp - 1;\n    if (tmpPageNumber > totalPages) {\n      break;\n    }\n    pageNumbers.push(tmpPageNumber);\n  }\n  if (pageNumbers.slice(-1)[0] !== totalPages) {\n    pageNumbers.push(totalPages);\n  }\n\n  return pageNumbers;\n};\n\ninterface PaginationChildProps extends PaginationOptions {\n  tableId?: string;\n  bootstrap4?: boolean;\n}\n\ninterface PaginationPanelProps extends PaginationChildProps {\n  renderSizePerPage: boolean;\n}\n\nexport const PaginationPanel: React.FC<PaginationPanelProps> = (props) => {\n  const {\n    renderSizePerPage,\n    totalSize,\n    sizePerPage,\n    sizePerPageList,\n    onSizePerPageChange,\n    page,\n    pageStartIndex,\n    onPageChange,\n  } = props;\n  if (\n    page === undefined ||\n    pageStartIndex === undefined ||\n    onPageChange === undefined ||\n    totalSize === undefined ||\n    sizePerPage === undefined ||\n    sizePerPageList === undefined ||\n    onSizePerPageChange === undefined\n  )\n    return null;\n  const totalPages = Math.ceil(totalSize / sizePerPage);\n  const pageNumbers = pageList(page, pageStartIndex, totalPages);\n\n  return (\n    <div className=\"pagination-panel-parent\">\n      {renderSizePerPage && (\n        <>\n          <Row>\n            <Col className=\"size-per-page\">\n              <span className=\"small\">\n                {'per page: '}\n                {(sizePerPageList as number[]).map((p) => (\n                  <a\n                    key={p}\n                    className={`standings-per-page${\n                      p === sizePerPage ? ' active' : ''\n                    }`}\n                    onClick={() => onSizePerPageChange(p, 1)}\n                  >\n                    {p}\n                  </a>\n                ))}\n              </span>\n            </Col>\n          </Row>\n          <hr className=\"size-per-page-splitter\" />\n        </>\n      )}\n      <Row>\n        <Col>\n          <Pagination\n            className=\"pagination-sm\"\n            style={{ flexWrap: 'wrap', justifyContent: 'center' }}\n          >\n            {pageNumbers.map((pageNumber) => (\n              <PaginationItem key={pageNumber} active={pageNumber === page}>\n                <PaginationLink\n                  onClick={() => onPageChange(pageNumber, sizePerPage)}\n                >\n                  {pageNumber}\n                </PaginationLink>\n              </PaginationItem>\n            ))}\n          </Pagination>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n","import React from 'react';\nimport { getRatingColorCode, RatingColor } from '../utils/RatingColor';\nimport './TopcoderLikeCircle.css';\n\ntype RatingMetalColor = 'Bronze' | 'Silver' | 'Gold';\nconst getRatingMetalColorCode = (metalColor: RatingMetalColor) => {\n  switch (metalColor) {\n    case 'Bronze':\n      return { base: '#965C2C', highlight: '#FFDABD' };\n    case 'Silver':\n      return { base: '#808080', highlight: 'white' };\n    case 'Gold':\n      return { base: '#FFD700', highlight: 'white' };\n  }\n};\n\ntype RatingColorWithMetal = RatingColor | RatingMetalColor;\nconst getStyleOptions = (color: RatingColorWithMetal, fillRatio: number) => {\n  if (color === 'Bronze' || color === 'Silver' || color === 'Gold') {\n    const metalColor = getRatingMetalColorCode(color);\n    return {\n      borderColor: metalColor.base,\n      background: `linear-gradient(to right, \\\n        ${metalColor.base}, ${metalColor.highlight}, ${metalColor.base})`,\n    };\n  } else {\n    const colorCode = getRatingColorCode(color);\n    return {\n      borderColor: colorCode,\n      background: `linear-gradient(to top, \\\n        ${colorCode} 0%, \\\n        ${colorCode} ${fillRatio * 100}%, \\\n        rgba(0,0,0,0) ${fillRatio * 100}%, \\\n        rgba(0,0,0,0) 100%)`,\n    };\n  }\n};\n\ninterface Props extends React.HTMLAttributes<HTMLElement> {\n  color: RatingColorWithMetal;\n  rating: number;\n  big?: boolean;\n}\n\nexport const TopcoderLikeCircle: React.FC<Props> = (props) => {\n  const { color, rating } = props;\n  const fillRatio = rating >= 3200 ? 1.0 : (rating % 400) / 400;\n  const className = `topcoder-like-circle \\\n    ${props.big ? 'topcoder-like-circle-big' : ''}`;\n  const styleOptions = getStyleOptions(color, fillRatio);\n  return (\n    <span\n      className={`${className} ${props.className ?? ''}`}\n      id={props.id}\n      style={styleOptions}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport { Badge, Tooltip } from 'reactstrap';\nimport { getRatingColor } from '../utils/RatingColor';\nimport { TopcoderLikeCircle } from './TopcoderLikeCircle';\nimport './RatingCircle.css';\n\ntype Rating = number;\n\ninterface Props {\n  id?: string;\n  rating?: Rating;\n}\n\nfunction getColor(rating: Rating) {\n  if (rating < 3200) {\n    return getRatingColor(rating);\n  } else if (rating < 3600) {\n    return 'Bronze';\n  } else if (rating < 4000) {\n    return 'Silver';\n  } else {\n    return 'Gold';\n  }\n}\n\nexport const RatingCircle: React.FC<Props> = (props) => {\n  const { id, rating } = props;\n  const [tooltipOpen, setTooltipOpen] = useState(false);\n  const toggleTooltipState = (): void => setTooltipOpen(!tooltipOpen);\n  const circleId = `RatingCircle-${id ?? ''}`;\n  if (rating === undefined || rating < 0) {\n    return (\n      <span>\n        <Badge\n          className=\"rating-unavailable-circle\"\n          color=\"info\"\n          id={circleId}\n          pill\n        >\n          ?\n        </Badge>\n        <Tooltip\n          placement=\"top\"\n          target={circleId}\n          isOpen={tooltipOpen}\n          toggle={toggleTooltipState}\n        >\n          Rating is unavailable.\n        </Tooltip>\n      </span>\n    );\n  }\n  const color = getColor(rating);\n\n  return (\n    <>\n      <TopcoderLikeCircle\n        color={color}\n        rating={rating}\n        className=\"rating-circle\"\n        id={circleId}\n      />\n      <Tooltip\n        placement=\"top\"\n        target={circleId}\n        isOpen={tooltipOpen}\n        toggle={toggleTooltipState}\n      >\n        {`Rating: ${rating}`}\n      </Tooltip>\n    </>\n  );\n};\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport BootstrapTable, {\n  ColumnDescription,\n  SortOrder,\n} from 'react-bootstrap-table-next';\nimport paginationFactory, {\n  PaginationProvider,\n} from 'react-bootstrap-table2-paginator';\nimport filterFactory, { textFilter } from 'react-bootstrap-table2-filter';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faSort,\n  faSortDown,\n  faSortUp,\n  faChartLine,\n} from '@fortawesome/free-solid-svg-icons';\nimport { PaginationPanel } from '../../components/PaginationPanel';\nimport { getColor, RankingEntry } from '../../utils/Rating';\nimport { RatingCircle } from '../../components/RatingCircle';\nimport './ranking-table.scss';\nimport { UncontrolledTooltip } from 'reactstrap';\n\nconst _sortCaret = (order: 'asc' | 'desc' | undefined): JSX.Element => {\n  if (order === 'asc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n          marginTop: '0.2rem',\n          marginBottom: '-0.2rem',\n        }}\n        icon={faSortUp}\n      />\n    );\n  if (order === 'desc')\n    return (\n      <FontAwesomeIcon\n        style={{\n          marginLeft: '6px',\n          marginTop: '-0.2rem',\n          marginBottom: '0.2rem',\n        }}\n        icon={faSortDown}\n      />\n    );\n  return <FontAwesomeIcon style={{ marginLeft: '6px' }} icon={faSort} />;\n};\n\ninterface Props {\n  ranking: RankingEntry[];\n}\n\nexport const RankingTable: React.FC<Props> = (props) => {\n  const { ranking } = props;\n\n  if (ranking.length === 0) {\n    return (\n      <div\n        style={{\n          width: '100%',\n          height: '500px',\n          textAlign: 'center',\n          marginTop: '100px',\n          marginBottom: '100px',\n        }}\n      >\n        Fetch data...\n      </div>\n    );\n  }\n\n  const columns: ColumnDescription[] = [\n    {\n      dataField: 'rank',\n      text: 'Rank',\n      sort: true,\n      classes: 'standings-rank',\n      headerClasses: 'standings-rank-head',\n      sortFunc: function _sortFunc(a: number, b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return a - b;\n        } else {\n          return b - a;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'username',\n      text: 'User',\n      sort: true,\n      classes: 'standings-username',\n      headerClasses: 'standings-username-head',\n      filter: textFilter(),\n      formatter: function _formatter(cell: string, _row: RankingEntry) {\n        const btnId = `ranking-user-btn-submission-${cell}`;\n        return (\n          <>\n            <a\n              href={`https://atcoder.jp/users/${cell}`}\n              className=\"username\"\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n              style={{ color: getColor(_row.rating)[1] }}\n            >\n              <RatingCircle id={cell} rating={_row.rating} />{' '}\n              <span className=\"user\">{cell}</span>\n            </a>\n            <span className=\"ranking-user-btn\">\n              <Link to={`/rating/${cell}`} id={btnId}>\n                <FontAwesomeIcon icon={faChartLine} />\n              </Link>\n              <UncontrolledTooltip placement=\"top\" target={btnId}>\n                {`view ${cell}'s rating history`}\n              </UncontrolledTooltip>\n            </span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(a: string, b: string, order: SortOrder) {\n        if (order === 'desc') {\n          return a > b ? 1 : -1;\n        } else {\n          return b < a ? -1 : 1;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'rating',\n      text: 'Rating',\n      sort: true,\n      classes: 'standings-rating',\n      headerClasses: 'standings-rating-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span style={{ color: getColor(cell)[1] }}>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'match',\n      text: 'Match',\n      sort: true,\n      classes: 'standings-match',\n      headerClasses: 'standings-match-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n    {\n      dataField: 'win',\n      text: 'Win',\n      sort: true,\n      classes: 'standings-win',\n      headerClasses: 'standings-win-head',\n      formatter: function _formatter(cell: number) {\n        return (\n          <>\n            <span>{cell}</span>\n          </>\n        );\n      },\n      sortFunc: function _sortFunc(_a: number, _b: number, order: SortOrder) {\n        if (order === 'desc') {\n          return _b - _a;\n        } else {\n          return _a - _b;\n        }\n      },\n      sortCaret: _sortCaret,\n    },\n  ];\n\n  return (\n    <>\n      <PaginationProvider\n        pagination={paginationFactory({\n          custom: true,\n          sizePerPage: 100,\n          sizePerPageList: [10, 20, 50, 100, 1000],\n          totalSize: ranking.length,\n        })}\n      >\n        {({ paginationProps, paginationTableProps }) => {\n          paginationTableProps.keyField = 'user_name';\n          paginationTableProps.data = ranking;\n          paginationTableProps.columns = columns;\n          return (\n            <div>\n              <PaginationPanel renderSizePerPage={true} {...paginationProps} />\n              <BootstrapTable\n                bootstrap4\n                classes=\"th-center th-middle td-center td-middle table-standings\"\n                striped\n                // keyField=\"user_name\"\n                // data={userStandingsEntries}\n                // columns={columns}\n                filter={filterFactory()}\n                wrapperClasses=\"table-responsive\"\n                {...paginationTableProps}\n              />\n              <PaginationPanel renderSizePerPage={false} {...paginationProps} />\n            </div>\n          );\n        }}\n      </PaginationProvider>\n      <hr />\n    </>\n  );\n};\n","import React from 'react';\nimport useSWR from 'swr';\nimport { Alert } from 'reactstrap';\nimport { Contest } from '../../interfaces/Contest';\nimport {\n  ContestResults,\n  fetchContestResults,\n  fetchContests,\n} from '../../utils/Data';\nimport { RankingEntry, RatingRanks } from '../../utils/Rating';\nimport { RankingTable } from './RankingTable';\n\nexport const RankingPage: React.FC = () => {\n  const { data: contests, error: contestsError } = useSWR<Contest[], Error>(\n    '/json/contests/contests',\n    fetchContests\n  );\n  const { data: contestResultsArray, error: contestResultsArrayError } = useSWR<\n    (ContestResults | undefined)[],\n    Error\n  >(contests ? `/json/results/` : null, () => {\n    if (!contests) return Promise.resolve([undefined]);\n    const promises = contests.map((contest) =>\n      fetchContestResults(contest.slug)\n    );\n    return Promise.all(promises);\n  });\n\n  const ratingRanks = new RatingRanks(contestResultsArray);\n  // {rank, rating, username}[]\n  const ranking: RankingEntry[] = ratingRanks.getRanking();\n\n  return (\n    <>\n      <h2>Description</h2>\n      <p>AtCoder で行われたマラソンコンテストの総合ランキングを表示します．</p>\n      <p>\n        AtCoder\n        が公式にマラソンレートの総合ランキング表示機能を実装するまでのつなぎです．\n      </p>\n      <hr />\n\n      {contestsError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest list.\n        </Alert>\n      ) : contests === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest data...\n        </div>\n      ) : contestResultsArrayError ? (\n        <Alert\n          color=\"danger\"\n          style={{\n            marginTop: '50px',\n            marginBottom: '50px',\n          }}\n        >\n          Failed to fetch contest results.\n        </Alert>\n      ) : contestResultsArray === undefined ? (\n        <div\n          style={{\n            width: '100%',\n            height: '500px',\n            textAlign: 'center',\n            marginTop: '100px',\n            marginBottom: '100px',\n          }}\n        >\n          Fetch contest results...\n        </div>\n      ) : (\n        <></>\n      )}\n      <RankingTable ranking={ranking} />\n    </>\n  );\n};\n","import React from 'react';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\nimport { Container } from 'reactstrap';\nimport { SWRConfig } from 'swr';\nimport { NavigationBar } from './components/NavigationBar';\n// import logo from './logo.svg';\nimport './App.css';\nimport { RatingPage } from './pages/rating';\nimport { RankingPage } from './pages/ranking';\n\nconst App: React.FC = () => {\n  return (\n    <div className=\"App\">\n      <SWRConfig value={{ revalidateOnFocus: false }}>\n        <Router>\n          <NavigationBar />\n          <Container\n            style={{ width: '100%', maxWidth: '90%', marginTop: '80px' }}\n          >\n            <Switch>\n              <Route\n                exact\n                path=\"/rating/:user\"\n                component={RatingPage as React.FC}\n              />\n              <Route exact path=\"/rating/\" component={RatingPage as React.FC} />\n              <Route exact path=\"/ranking/\" component={RankingPage} />\n              <Redirect path=\"/\" to=\"/rating/\" />\n            </Switch>\n          </Container>\n          <footer\n            className=\"footer\"\n            style={{\n              marginTop: '30px',\n              padding: '30px',\n              backgroundColor: '#efefef',\n            }}\n          >\n            <div className=\"container\">\n              連絡先:{' '}\n              <a\n                href=\"https://twitter.com/iiljj\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                si (@iiljj) / Twitter\n              </a>\n              {', '}\n              <a\n                href=\"https://github.com/iilj\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                iilj (iilj) / GitHub\n              </a>\n            </div>\n          </footer>\n        </Router>\n      </SWRConfig>\n    </div>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    void import('web-vitals').then(\n      ({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n        getCLS(onPerfEntry);\n        getFID(onPerfEntry);\n        getFCP(onPerfEntry);\n        getLCP(onPerfEntry);\n        getTTFB(onPerfEntry);\n      }\n    );\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}